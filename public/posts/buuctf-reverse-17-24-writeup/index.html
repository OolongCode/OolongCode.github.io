<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="BUUCTF-REVERSE-[17-24] writeup 8道练手的逆向题目，可以尝试做一做
0x0 [GWCTF 2019] pyre 应该是python逆向的题目
果然是一个pyc文件，使用pyc的逆向工具进行处理得到python的代码
# uncompyle6 version 3.7.4 # Python bytecode 2.7 (62211) # Decompiled from: Python 3.8.8 (default, Apr 13 2021, 15:08:03) [MSC v.1916 64 bit (AMD64)] # Embedded file name: encode.py # Compiled at: 2019-08-19 21:01:57 print &amp;#39;Welcome to Re World!&amp;#39; print &amp;#39;Your input1 is your flag~&amp;#39; l = len(input1) for i in range(l): num = ((input1[i] &#43; i) % 128 &#43; 128) % 128 code &#43;= num for i in range(l - 1): code[i] = code[i] ^ code[(i &#43; 1)] print code code = [&amp;#39;\x1f&amp;#39;, &amp;#39;\x12&amp;#39;, &amp;#39;\x1d&amp;#39;, &amp;#39;(&amp;#39;, &amp;#39;0&amp;#39;, &amp;#39;4&amp;#39;, &amp;#39;\x01&amp;#39;, &amp;#39;\x06&amp;#39;, &amp;#39;\x14&amp;#39;, &amp;#39;4&amp;#39;, &amp;#39;,&amp;#39;, &amp;#39;\x1b&amp;#39;, &amp;#39;U&amp;#39;, &amp;#39;?" />
<meta name="keywords" content=", CTF" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://zcodetea.github.io/posts/buuctf-reverse-17-24-writeup/" />


    <title>
        
            BUUCTF REVERSE [17 24] Writeup :: ZCodeTea Blog  — A simple learner
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.031a8efc33f94f55a4071bf4e91596478a5809fc8c148fab113801189cfd2152.css">






<meta itemprop="name" content="BUUCTF REVERSE [17 24] Writeup">
<meta itemprop="description" content="BUUCTF-REVERSE-[17-24] writeup 8道练手的逆向题目，可以尝试做一做
0x0 [GWCTF 2019] pyre 应该是python逆向的题目
果然是一个pyc文件，使用pyc的逆向工具进行处理得到python的代码
# uncompyle6 version 3.7.4 # Python bytecode 2.7 (62211) # Decompiled from: Python 3.8.8 (default, Apr 13 2021, 15:08:03) [MSC v.1916 64 bit (AMD64)] # Embedded file name: encode.py # Compiled at: 2019-08-19 21:01:57 print &#39;Welcome to Re World!&#39; print &#39;Your input1 is your flag~&#39; l = len(input1) for i in range(l): num = ((input1[i] &#43; i) % 128 &#43; 128) % 128 code &#43;= num for i in range(l - 1): code[i] = code[i] ^ code[(i &#43; 1)] print code code = [&#39;\x1f&#39;, &#39;\x12&#39;, &#39;\x1d&#39;, &#39;(&#39;, &#39;0&#39;, &#39;4&#39;, &#39;\x01&#39;, &#39;\x06&#39;, &#39;\x14&#39;, &#39;4&#39;, &#39;,&#39;, &#39;\x1b&#39;, &#39;U&#39;, &#39;?"><meta itemprop="datePublished" content="2022-01-28T19:24:35+08:00" />
<meta itemprop="dateModified" content="2022-01-28T19:24:35+08:00" />
<meta itemprop="wordCount" content="2555"><meta itemprop="image" content="https://zcodetea.github.io/"/>
<meta itemprop="keywords" content="CTF," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://zcodetea.github.io/"/>

<meta name="twitter:title" content="BUUCTF REVERSE [17 24] Writeup"/>
<meta name="twitter:description" content="BUUCTF-REVERSE-[17-24] writeup 8道练手的逆向题目，可以尝试做一做
0x0 [GWCTF 2019] pyre 应该是python逆向的题目
果然是一个pyc文件，使用pyc的逆向工具进行处理得到python的代码
# uncompyle6 version 3.7.4 # Python bytecode 2.7 (62211) # Decompiled from: Python 3.8.8 (default, Apr 13 2021, 15:08:03) [MSC v.1916 64 bit (AMD64)] # Embedded file name: encode.py # Compiled at: 2019-08-19 21:01:57 print &#39;Welcome to Re World!&#39; print &#39;Your input1 is your flag~&#39; l = len(input1) for i in range(l): num = ((input1[i] &#43; i) % 128 &#43; 128) % 128 code &#43;= num for i in range(l - 1): code[i] = code[i] ^ code[(i &#43; 1)] print code code = [&#39;\x1f&#39;, &#39;\x12&#39;, &#39;\x1d&#39;, &#39;(&#39;, &#39;0&#39;, &#39;4&#39;, &#39;\x01&#39;, &#39;\x06&#39;, &#39;\x14&#39;, &#39;4&#39;, &#39;,&#39;, &#39;\x1b&#39;, &#39;U&#39;, &#39;?"/>




    <meta property="og:title" content="BUUCTF REVERSE [17 24] Writeup" />
<meta property="og:description" content="BUUCTF-REVERSE-[17-24] writeup 8道练手的逆向题目，可以尝试做一做
0x0 [GWCTF 2019] pyre 应该是python逆向的题目
果然是一个pyc文件，使用pyc的逆向工具进行处理得到python的代码
# uncompyle6 version 3.7.4 # Python bytecode 2.7 (62211) # Decompiled from: Python 3.8.8 (default, Apr 13 2021, 15:08:03) [MSC v.1916 64 bit (AMD64)] # Embedded file name: encode.py # Compiled at: 2019-08-19 21:01:57 print &#39;Welcome to Re World!&#39; print &#39;Your input1 is your flag~&#39; l = len(input1) for i in range(l): num = ((input1[i] &#43; i) % 128 &#43; 128) % 128 code &#43;= num for i in range(l - 1): code[i] = code[i] ^ code[(i &#43; 1)] print code code = [&#39;\x1f&#39;, &#39;\x12&#39;, &#39;\x1d&#39;, &#39;(&#39;, &#39;0&#39;, &#39;4&#39;, &#39;\x01&#39;, &#39;\x06&#39;, &#39;\x14&#39;, &#39;4&#39;, &#39;,&#39;, &#39;\x1b&#39;, &#39;U&#39;, &#39;?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zcodetea.github.io/posts/buuctf-reverse-17-24-writeup/" /><meta property="og:image" content="https://zcodetea.github.io/"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-28T19:24:35+08:00" />
<meta property="article:modified_time" content="2022-01-28T19:24:35+08:00" /><meta property="og:site_name" content="ZCodeTea Blog" />







    <meta property="article:published_time" content="2022-01-28 19:24:35 &#43;0800 CST" />










<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/monokai.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">vim flag</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/posts">Blog</a></li><li><a href="/tags">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        12 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://zcodetea.github.io/posts/buuctf-reverse-17-24-writeup/">BUUCTF REVERSE [17 24] Writeup</a>
      </h1>

      

      
        <hr />
        <aside id="toc">
          <div class="toc-title">Table of Contents</div>
          <nav id="TableOfContents">
  <ul>
    <li><a href="#0x0-gwctf-2019-pyre">0x0 [GWCTF 2019] pyre</a></li>
    <li><a href="#0x1-rsa">0x1 rsa</a></li>
    <li><a href="#0x2-actf新生赛-easyre">0x2 [ACTF新生赛] easyre</a></li>
    <li><a href="#0x3-crackrtf">0x3 CrackRTF</a></li>
    <li><a href="#0x4-2019红帽杯-easyre">0x4 [2019红帽杯] easyRE</a></li>
    <li><a href="#0x5-actf新生赛2020-rome">0x5 [ACTF新生赛2020] rome</a></li>
    <li><a href="#0x6-flareon4-login">0x6 [FlareOn4] login</a></li>
    <li><a href="#0x7-guet-ctf2019-re">0x7 [GUET-CTF2019] re</a></li>
  </ul>
</nav>
        </aside>
        <hr />

      

      <div class="post-content">
        <h1 id="buuctf-reverse-17-24-writeup">BUUCTF-REVERSE-[17-24] writeup</h1>
<p>8道练手的逆向题目，可以尝试做一做</p>
<p><img src="/images/BUUCTF-REVERSE-%5B17-24%5D_writeup/image-20210914212658475.png" alt="image-20210914212658475"></p>
<h2 id="0x0-gwctf-2019-pyre">0x0 [GWCTF 2019] pyre</h2>
<p>应该是python逆向的题目</p>
<p>果然是一个pyc文件，使用pyc的逆向工具进行处理得到python的代码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># uncompyle6 version 3.7.4</span>
<span style="color:#75715e"># Python bytecode 2.7 (62211)</span>
<span style="color:#75715e"># Decompiled from: Python 3.8.8 (default, Apr 13 2021, 15:08:03) [MSC v.1916 64 bit (AMD64)]</span>
<span style="color:#75715e"># Embedded file name: encode.py</span>
<span style="color:#75715e"># Compiled at: 2019-08-19 21:01:57</span>
print <span style="color:#e6db74">&#39;Welcome to Re World!&#39;</span>
print <span style="color:#e6db74">&#39;Your input1 is your flag~&#39;</span>
l <span style="color:#f92672">=</span> len(input1)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(l):
    num <span style="color:#f92672">=</span> ((input1[i] <span style="color:#f92672">+</span> i) <span style="color:#f92672">%</span> <span style="color:#ae81ff">128</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">128</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">128</span>
    code <span style="color:#f92672">+=</span> num

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(l <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>):
    code[i] <span style="color:#f92672">=</span> code[i] <span style="color:#f92672">^</span> code[(i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)]

print code
code <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x1f</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x12</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;(&#39;</span>, <span style="color:#e6db74">&#39;0&#39;</span>, <span style="color:#e6db74">&#39;4&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x06</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x14</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;4&#39;</span>, <span style="color:#e6db74">&#39;,&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;U&#39;</span>, <span style="color:#e6db74">&#39;?&#39;</span>, <span style="color:#e6db74">&#39;o&#39;</span>, <span style="color:#e6db74">&#39;6&#39;</span>, <span style="color:#e6db74">&#39;*&#39;</span>, <span style="color:#e6db74">&#39;:&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;D&#39;</span>, <span style="color:#e6db74">&#39;;&#39;</span>, <span style="color:#e6db74">&#39;%&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">&#39;</span>]
<span style="color:#75715e"># okay decompiling .\attachment.pyc</span>
</code></pre></div><p>对代码进行审计，发现<code>input1</code>的数值没有给到，感觉应该是在<code>input1</code>里面。根据代码进行逆推</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">code <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x1f</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x12</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;(&#39;</span>, <span style="color:#e6db74">&#39;0&#39;</span>, <span style="color:#e6db74">&#39;4&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x06</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x14</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;4&#39;</span>, <span style="color:#e6db74">&#39;,&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;U&#39;</span>, <span style="color:#e6db74">&#39;?&#39;</span>, <span style="color:#e6db74">&#39;o&#39;</span>, <span style="color:#e6db74">&#39;6&#39;</span>, <span style="color:#e6db74">&#39;*&#39;</span>, <span style="color:#e6db74">&#39;:&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;D&#39;</span>, <span style="color:#e6db74">&#39;;&#39;</span>, <span style="color:#e6db74">&#39;%&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">&#39;</span>]
l <span style="color:#f92672">=</span> len(code)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(l<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
    code[i] <span style="color:#f92672">=</span> chr(ord(code[i])<span style="color:#f92672">^</span>ord(code[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]))

flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(l):
    flag <span style="color:#f92672">+=</span> chr((ord(code[i]) <span style="color:#f92672">-</span> i)<span style="color:#f92672">%</span><span style="color:#ae81ff">128</span>)

print(flag)
</code></pre></div><p>运行脚本，得到flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">GWHT{Just_Re_1s_Ha66y!}
</code></pre></div><h2 id="0x1-rsa">0x1 rsa</h2>
<p>rsa还能出逆向题目：D！Crypto手狂喜</p>
<p>两个文件，一个enc文件和一个key文件，标准的RSA文件</p>
<p>可以使用python脚本来获取n的数值和e的数据</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> Crypto.PublicKey <span style="color:#f92672">import</span> RSA
<span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;pub.key&#34;</span>,<span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> f:
     public_key <span style="color:#f92672">=</span> RSA<span style="color:#f92672">.</span>import_key(f<span style="color:#f92672">.</span>read())
     e <span style="color:#f92672">=</span> public_key<span style="color:#f92672">.</span>e
     n <span style="color:#f92672">=</span> public_key<span style="color:#f92672">.</span>n

print(n)
</code></pre></div><p>得到n的数值</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">86934482296048119190666062003494800588905656017203025617216654058378322103517
</code></pre></div><p>然后使用yafu工具进行大数分解，得到p和q</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">P = 304008741604601924494328155975272418463
Q = 285960468890451637935629440372639283459
</code></pre></div><p>然后根据后续得到是数据写脚本求解</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> Crypto.PublicKey <span style="color:#f92672">import</span> RSA
<span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> long_to_bytes,bytes_to_long
<span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> invmod
<span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;pub.key&#34;</span>,<span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> f:
     public_key <span style="color:#f92672">=</span> RSA<span style="color:#f92672">.</span>import_key(f<span style="color:#f92672">.</span>read())
     e <span style="color:#f92672">=</span> public_key<span style="color:#f92672">.</span>e
     n <span style="color:#f92672">=</span> public_key<span style="color:#f92672">.</span>n

<span style="color:#75715e"># print(n)</span>
<span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;flag.enc&#34;</span>,<span style="color:#e6db74">&#34;rb&#34;</span>) <span style="color:#66d9ef">as</span> f:
     c <span style="color:#f92672">=</span> bytes_to_long(f<span style="color:#f92672">.</span>read())
p <span style="color:#f92672">=</span> <span style="color:#ae81ff">304008741604601924494328155975272418463</span>
q <span style="color:#f92672">=</span> <span style="color:#ae81ff">285960468890451637935629440372639283459</span>

phi <span style="color:#f92672">=</span> (p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>(q<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
d <span style="color:#f92672">=</span> invmod(e,phi)
m <span style="color:#f92672">=</span> pow(c,d,n)
flag <span style="color:#f92672">=</span> long_to_bytes(m)

print(flag)
</code></pre></div><p>运行脚本得到flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">b&#39;\x02\x9d {zR\x1e\x08\xe4\xe6\x18\x06\x00flag{decrypt_256}\n&#39;
</code></pre></div><p>flag即为</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">flag{decrypt_256}
</code></pre></div><h2 id="0x2-actf新生赛-easyre">0x2 [ACTF新生赛] easyre</h2>
<p>走下流程，查下壳</p>
<p><img src="/images/BUUCTF-REVERSE-%5B17-24%5D_writeup/image-20210915090016298.png" alt="image-20210915090016298"></p>
<p>发现有壳，需要进行脱壳</p>
<p>使用UPX进行脱壳处理</p>
<p><img src="/images/BUUCTF-REVERSE-%5B17-24%5D_writeup/image-20210915090432391.png" alt="image-20210915090432391"></p>
<p>然后再次查看信息</p>
<p><img src="/images/BUUCTF-REVERSE-%5B17-24%5D_writeup/image-20210915090516027.png" alt="image-20210915090516027"></p>
<p>32位程序，已经成功脱壳，可以丢进ida pro里面玩耍了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__cdecl</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>argv, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>envp)
{
  _BYTE v4[<span style="color:#ae81ff">12</span>]; <span style="color:#75715e">// [esp+12h] [ebp-2Eh] BYREF
</span><span style="color:#75715e"></span>  _DWORD v5[<span style="color:#ae81ff">3</span>]; <span style="color:#75715e">// [esp+1Eh] [ebp-22h]
</span><span style="color:#75715e"></span>  _BYTE v6[<span style="color:#ae81ff">5</span>]; <span style="color:#75715e">// [esp+2Ah] [ebp-16h] BYREF
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v7; <span style="color:#75715e">// [esp+2Fh] [ebp-11h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v8; <span style="color:#75715e">// [esp+33h] [ebp-Dh]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v9; <span style="color:#75715e">// [esp+37h] [ebp-9h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v10; <span style="color:#75715e">// [esp+3Bh] [ebp-5h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// [esp+3Ch] [ebp-4h]
</span><span style="color:#75715e"></span>
  __main();
  qmemcpy(v4, <span style="color:#e6db74">&#34;*F&#39;</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">N,</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">(I?+@&#34;</span>, <span style="color:#66d9ef">sizeof</span>(v4));
  printf(<span style="color:#e6db74">&#34;Please input:&#34;</span>);
  scanf(<span style="color:#e6db74">&#34;%s&#34;</span>, v6);
  <span style="color:#66d9ef">if</span> ( v6[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">65</span> <span style="color:#f92672">||</span> v6[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">67</span> <span style="color:#f92672">||</span> v6[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">84</span> <span style="color:#f92672">||</span> v6[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">70</span> <span style="color:#f92672">||</span> v6[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">123</span> <span style="color:#f92672">||</span> v10 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">125</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
  v5[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> v7;
  v5[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> v8;
  v5[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> v9;
  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">11</span>; <span style="color:#f92672">++</span>i )
  {
    <span style="color:#66d9ef">if</span> ( v4[i] <span style="color:#f92672">!=</span> _data_start__[<span style="color:#f92672">*</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)v5 <span style="color:#f92672">+</span> i) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] )
      <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
  }
  printf(<span style="color:#e6db74">&#34;You are correct!&#34;</span>);
  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p>就是非常简单的算法了，进行简单的逆向算法就可以求解，写一个python脚本进行求解</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data_list <span style="color:#f92672">=</span> [<span style="color:#ae81ff">42</span>,<span style="color:#ae81ff">70</span>,<span style="color:#ae81ff">39</span>,<span style="color:#ae81ff">34</span>,<span style="color:#ae81ff">78</span>,<span style="color:#ae81ff">44</span>,<span style="color:#ae81ff">34</span>,<span style="color:#ae81ff">40</span>,<span style="color:#ae81ff">73</span>,<span style="color:#ae81ff">63</span>,<span style="color:#ae81ff">43</span>,<span style="color:#ae81ff">64</span>]

data <span style="color:#f92672">=</span> <span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;}|{zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(&#34;</span> <span style="color:#f92672">+</span> chr(<span style="color:#ae81ff">0x27</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;&amp;%$# !&#34;&#39;</span>

flag_list <span style="color:#f92672">=</span> []

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> data_list:
    flag_list<span style="color:#f92672">.</span>append(data<span style="color:#f92672">.</span>find(chr(i))<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
s <span style="color:#f92672">=</span> [chr(x <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> pos]
flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(s)
print (<span style="color:#e6db74">&#39;flag{&#39;</span><span style="color:#f92672">+</span>flag<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;}&#39;</span>)
</code></pre></div><p>运行脚本就可以得到flag：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">flag{U9X_1S_W6@T?}
</code></pre></div><h2 id="0x3-crackrtf">0x3 CrackRTF</h2>
<p>先查一下壳</p>
<p><img src="/images/BUUCTF-REVERSE-%5B17-24%5D_writeup/image-20210915115948303.png" alt="image-20210915115948303"></p>
<p>32位无壳的pe文件，使用ida pro打开文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__cdecl</span> <span style="color:#a6e22e">main_0</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>argv, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>envp)
{
  DWORD v3; <span style="color:#75715e">// eax
</span><span style="color:#75715e"></span>  DWORD v4; <span style="color:#75715e">// eax
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> Str[<span style="color:#ae81ff">260</span>]; <span style="color:#75715e">// [esp+4Ch] [ebp-310h] BYREF
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v7; <span style="color:#75715e">// [esp+150h] [ebp-20Ch]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> String1[<span style="color:#ae81ff">260</span>]; <span style="color:#75715e">// [esp+154h] [ebp-208h] BYREF
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> Destination[<span style="color:#ae81ff">260</span>]; <span style="color:#75715e">// [esp+258h] [ebp-104h] BYREF
</span><span style="color:#75715e"></span>
  memset(Destination, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(Destination));
  memset(String1, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(String1));
  v7 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  printf(<span style="color:#e6db74">&#34;pls input the first passwd(1): &#34;</span>);
  scanf(<span style="color:#e6db74">&#34;%s&#34;</span>, Destination);
  <span style="color:#66d9ef">if</span> ( strlen(Destination) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">6</span> )
  {
    printf(<span style="color:#e6db74">&#34;Must be 6 characters!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
    ExitProcess(<span style="color:#ae81ff">0</span>);
  }
  v7 <span style="color:#f92672">=</span> atoi(Destination);
  <span style="color:#66d9ef">if</span> ( v7 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">100000</span> )
    ExitProcess(<span style="color:#ae81ff">0</span>);
  strcat(Destination, <span style="color:#e6db74">&#34;@DBApp&#34;</span>);
  v3 <span style="color:#f92672">=</span> strlen(Destination);
  sub_40100A((BYTE <span style="color:#f92672">*</span>)Destination, v3, String1);
  <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>_strcmpi(String1, <span style="color:#e6db74">&#34;6E32D0943418C2C33385BC35A1470250DD8923A9&#34;</span>) )
  {
    printf(<span style="color:#e6db74">&#34;continue...</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span>);
    printf(<span style="color:#e6db74">&#34;pls input the first passwd(2): &#34;</span>);
    memset(Str, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(Str));
    scanf(<span style="color:#e6db74">&#34;%s&#34;</span>, Str);
    <span style="color:#66d9ef">if</span> ( strlen(Str) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">6</span> )
    {
      printf(<span style="color:#e6db74">&#34;Must be 6 characters!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
      ExitProcess(<span style="color:#ae81ff">0</span>);
    }
    strcat(Str, Destination);
    memset(String1, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(String1));
    v4 <span style="color:#f92672">=</span> strlen(Str);
    sub_401019((BYTE <span style="color:#f92672">*</span>)Str, v4, String1);
    <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>_strcmpi(<span style="color:#e6db74">&#34;27019e688a4e62a649fd99cadaafdb4e&#34;</span>, String1) )
    {
      <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)sub_40100F(Str) )
      {
        printf(<span style="color:#e6db74">&#34;Error!!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
        ExitProcess(<span style="color:#ae81ff">0</span>);
      }
      printf(<span style="color:#e6db74">&#34;bye ~~</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
    }
  }
  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p>对代码进行审计分析，发现我们需要输入两次密码</p>
<p>首先看下第一次密码输入需要满足什么样的要求：</p>
<p>第一次输入需要进行链接然后使用md5加密然后获取的数值与某些数值相等，也就是:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">MD5(xxxxxx@DBAPP) == 6E32D0943418C2C33385BC35A1470250DD8923A9
</code></pre></div><p>sub_40100A函数代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__cdecl</span> <span style="color:#a6e22e">sub_401230</span>(BYTE <span style="color:#f92672">*</span>pbData, DWORD dwDataLen, LPSTR lpString1)
{
  <span style="color:#66d9ef">int</span> result; <span style="color:#75715e">// eax
</span><span style="color:#75715e"></span>  DWORD i; <span style="color:#75715e">// [esp+4Ch] [ebp-28h]
</span><span style="color:#75715e"></span>  CHAR String2[<span style="color:#ae81ff">4</span>]; <span style="color:#75715e">// [esp+50h] [ebp-24h] BYREF
</span><span style="color:#75715e"></span>  BYTE v6[<span style="color:#ae81ff">20</span>]; <span style="color:#75715e">// [esp+54h] [ebp-20h] BYREF
</span><span style="color:#75715e"></span>  DWORD pdwDataLen; <span style="color:#75715e">// [esp+68h] [ebp-Ch] BYREF
</span><span style="color:#75715e"></span>  HCRYPTHASH phHash; <span style="color:#75715e">// [esp+6Ch] [ebp-8h] BYREF
</span><span style="color:#75715e"></span>  HCRYPTPROV phProv; <span style="color:#75715e">// [esp+70h] [ebp-4h] BYREF
</span><span style="color:#75715e"></span>
  <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>CryptAcquireContextA(<span style="color:#f92672">&amp;</span>phProv, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1u</span>, <span style="color:#ae81ff">0xF0000000</span>) )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
  <span style="color:#66d9ef">if</span> ( CryptCreateHash(phProv, <span style="color:#ae81ff">0x8004u</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#f92672">&amp;</span>phHash) )
  {
    <span style="color:#66d9ef">if</span> ( CryptHashData(phHash, pbData, dwDataLen, <span style="color:#ae81ff">0</span>) )
    {
      CryptGetHashParam(phHash, <span style="color:#ae81ff">2u</span>, v6, <span style="color:#f92672">&amp;</span>pdwDataLen, <span style="color:#ae81ff">0</span>);
      <span style="color:#f92672">*</span>lpString1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
      <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> pdwDataLen; <span style="color:#f92672">++</span>i )
      {
        wsprintfA(String2, <span style="color:#e6db74">&#34;%02X&#34;</span>, v6[i]);
        lstrcatA(lpString1, String2);
      }
      CryptDestroyHash(phHash);
      CryptReleaseContext(phProv, <span style="color:#ae81ff">0</span>);
      result <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
    }
    <span style="color:#66d9ef">else</span>
    {
      CryptDestroyHash(phHash);
      CryptReleaseContext(phProv, <span style="color:#ae81ff">0</span>);
      result <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    }
  }
  <span style="color:#66d9ef">else</span>
  {
    CryptReleaseContext(phProv, <span style="color:#ae81ff">0</span>);
    result <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  }
  <span style="color:#66d9ef">return</span> result;
}
</code></pre></div><p>程序直接调用WIN32的API函数进行调用来进行MD5的加密</p>
<p>使用在线的<a href="https://www.somd5.com/">MD5工具</a>进行解密获得：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">123321@DBApp
</code></pre></div><p>下面解决一下第二次加密的问题，第二次加密显然也是一个MD5的比较问题，即：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">MD5(xxxxxx123321@DBApp@DBAPP) == 27019e688a4e62a649fd99cadaafdb4e
</code></pre></div><p>同样使用上面那个MD5的工具进行求解就可以得到数据：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">~!3a@0123321@DBApp
</code></pre></div><p>现在得到了所有的密码，是不是可以运行一下程序来得到结果：</p>
<p>运行程序得到了一个rtf文件，打开rtf文件就能得到flag啦：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">Flag{N0_M0re_Free_Bugs}
</code></pre></div><h2 id="0x4-2019红帽杯-easyre">0x4 [2019红帽杯] easyRE</h2>
<p>得到一个ELF文件，可以确定是Linux系统的文件，虽然Linux系统的大多数文件是不带壳的，但是为了以防万一还是查下程序信息：</p>
<p><img src="/images/BUUCTF-REVERSE-%5B17-24%5D_writeup/image-20210918150158372.png" alt="image-20210918150158372"></p>
<p>64位程序，果然是没有壳的程序。使用x64 IDA pro打开一下程序，看看程序内部</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">// positive sp value has been detected, the output may be wrong!
</span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#66d9ef">__fastcall</span> __noreturn <span style="color:#a6e22e">start</span>(<span style="color:#66d9ef">__int64</span> a1, <span style="color:#66d9ef">__int64</span> a2, <span style="color:#66d9ef">int</span> a3)
{
  <span style="color:#66d9ef">__int64</span> v3; <span style="color:#75715e">// rax
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v4; <span style="color:#75715e">// esi
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v5; <span style="color:#75715e">// [rsp-8h] [rbp-8h] BYREF
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>retaddr; <span style="color:#75715e">// [rsp+0h] [rbp+0h] BYREF
</span><span style="color:#75715e"></span>
  v4 <span style="color:#f92672">=</span> v5;
  v5 <span style="color:#f92672">=</span> v3;
  sub_401BC0(
    (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)sub_4009C6,
    v4,
    (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)<span style="color:#f92672">&amp;</span>retaddr,
    (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)sub_402080,
    (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)sub_402110,
    a3,
    (<span style="color:#66d9ef">__int64</span>)<span style="color:#f92672">&amp;</span>v5);
}
</code></pre></div><p>好像是找不到什么具体的内容，使用字符串检索定位到关键函数的位置</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">__int64</span> <span style="color:#a6e22e">sub_4009C6</span>()
{
  <span style="color:#66d9ef">__int64</span> result; <span style="color:#75715e">// rax
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// [rsp+Ch] [rbp-114h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v2; <span style="color:#75715e">// [rsp+10h] [rbp-110h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v3; <span style="color:#75715e">// [rsp+18h] [rbp-108h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v4; <span style="color:#75715e">// [rsp+20h] [rbp-100h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v5; <span style="color:#75715e">// [rsp+28h] [rbp-F8h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v6; <span style="color:#75715e">// [rsp+30h] [rbp-F0h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v7; <span style="color:#75715e">// [rsp+38h] [rbp-E8h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v8; <span style="color:#75715e">// [rsp+40h] [rbp-E0h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v9; <span style="color:#75715e">// [rsp+48h] [rbp-D8h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v10; <span style="color:#75715e">// [rsp+50h] [rbp-D0h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v11; <span style="color:#75715e">// [rsp+58h] [rbp-C8h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v12[<span style="color:#ae81ff">13</span>]; <span style="color:#75715e">// [rsp+60h] [rbp-C0h] BYREF
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v13[<span style="color:#ae81ff">4</span>]; <span style="color:#75715e">// [rsp+6Dh] [rbp-B3h] BYREF
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v14[<span style="color:#ae81ff">19</span>]; <span style="color:#75715e">// [rsp+71h] [rbp-AFh] BYREF
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v15[<span style="color:#ae81ff">32</span>]; <span style="color:#75715e">// [rsp+90h] [rbp-90h] BYREF
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v16; <span style="color:#75715e">// [rsp+B0h] [rbp-70h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v17; <span style="color:#75715e">// [rsp+B4h] [rbp-6Ch]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v18[<span style="color:#ae81ff">72</span>]; <span style="color:#75715e">// [rsp+C0h] [rbp-60h] BYREF
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int64</span> v19; <span style="color:#75715e">// [rsp+108h] [rbp-18h]
</span><span style="color:#75715e"></span>
  v19 <span style="color:#f92672">=</span> __readfsqword(<span style="color:#ae81ff">0x28u</span>);
  qmemcpy(v12, <span style="color:#e6db74">&#34;Iodl&gt;Qnb(ocy&#34;</span>, <span style="color:#ae81ff">12</span>);
  v12[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">127</span>;
  qmemcpy(v13, <span style="color:#e6db74">&#34;y.i&#34;</span>, <span style="color:#ae81ff">3</span>);
  v13[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">127</span>;
  qmemcpy(v14, <span style="color:#e6db74">&#34;d`3w}wek9{iy=~yL@EC&#34;</span>, <span style="color:#66d9ef">sizeof</span>(v14));
  memset(v15, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(v15));
  v16 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  v17 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  sub_4406E0(<span style="color:#ae81ff">0LL</span>, v15, <span style="color:#ae81ff">37LL</span>);
  v17 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  <span style="color:#66d9ef">if</span> ( sub_424BA0(v15) <span style="color:#f92672">==</span> <span style="color:#ae81ff">36</span> )
  {
    <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int64</span>)sub_424BA0(v15); <span style="color:#f92672">++</span>i )
    {
      <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)(v15[i] <span style="color:#f92672">^</span> i) <span style="color:#f92672">!=</span> v12[i] )
      {
        result <span style="color:#f92672">=</span> <span style="color:#ae81ff">4294967294LL</span>;
        <span style="color:#66d9ef">goto</span> LABEL_13;
      }
    }
    sub_410CC0(<span style="color:#e6db74">&#34;continue!&#34;</span>);
    memset(v18, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x40uLL</span>);
    v18[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    sub_4406E0(<span style="color:#ae81ff">0LL</span>, v18, <span style="color:#ae81ff">64LL</span>);
    v18[<span style="color:#ae81ff">39</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">if</span> ( sub_424BA0(v18) <span style="color:#f92672">==</span> <span style="color:#ae81ff">39</span> )
    {
      v2 <span style="color:#f92672">=</span> sub_400E44(v18);
      v3 <span style="color:#f92672">=</span> sub_400E44(v2);
      v4 <span style="color:#f92672">=</span> sub_400E44(v3);
      v5 <span style="color:#f92672">=</span> sub_400E44(v4);
      v6 <span style="color:#f92672">=</span> sub_400E44(v5);
      v7 <span style="color:#f92672">=</span> sub_400E44(v6);
      v8 <span style="color:#f92672">=</span> sub_400E44(v7);
      v9 <span style="color:#f92672">=</span> sub_400E44(v8);
      v10 <span style="color:#f92672">=</span> sub_400E44(v9);
      v11 <span style="color:#f92672">=</span> sub_400E44(v10);
      <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)sub_400360(v11, off_6CC090) )
      {
        sub_410CC0(<span style="color:#e6db74">&#34;You found me!!!&#34;</span>);
        sub_410CC0(<span style="color:#e6db74">&#34;bye bye~&#34;</span>);
      }
      result <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
    }
    <span style="color:#66d9ef">else</span>
    {
      result <span style="color:#f92672">=</span> <span style="color:#ae81ff">4294967293LL</span>;
    }
  }
  <span style="color:#66d9ef">else</span>
  {
    result <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xFFFFFFFFLL</span>;
  }
LABEL_13:
  <span style="color:#66d9ef">if</span> ( __readfsqword(<span style="color:#ae81ff">0x28u</span>) <span style="color:#f92672">!=</span> v19 )
    sub_444020();
  <span style="color:#66d9ef">return</span> result;
}
</code></pre></div><p>找到关键函数，下面就是对关键函数进行分析来寻找线索</p>
<p>简单对代码进行审计，可以发现有很多混淆来防止我们进行正确的逆向分析操作</p>
<p>来，让我们跳进第一个坑：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"> v19 <span style="color:#f92672">=</span> __readfsqword(<span style="color:#ae81ff">0x28u</span>);
  qmemcpy(v12, <span style="color:#e6db74">&#34;Iodl&gt;Qnb(ocy&#34;</span>, <span style="color:#ae81ff">12</span>);
  v12[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">127</span>;
  qmemcpy(v13, <span style="color:#e6db74">&#34;y.i&#34;</span>, <span style="color:#ae81ff">3</span>);
  v13[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">127</span>;
  qmemcpy(v14, <span style="color:#e6db74">&#34;d`3w}wek9{iy=~yL@EC&#34;</span>, <span style="color:#66d9ef">sizeof</span>(v14));
  memset(v15, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(v15));
  v16 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  v17 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  sub_4406E0(<span style="color:#ae81ff">0LL</span>, v15, <span style="color:#ae81ff">37LL</span>);
  v17 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  <span style="color:#66d9ef">if</span> ( sub_424BA0(v15) <span style="color:#f92672">==</span> <span style="color:#ae81ff">36</span> )
  {
    <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int64</span>)sub_424BA0(v15); <span style="color:#f92672">++</span>i )
    {
      <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)(v15[i] <span style="color:#f92672">^</span> i) <span style="color:#f92672">!=</span> v12[i] )
      {
        result <span style="color:#f92672">=</span> <span style="color:#ae81ff">4294967294LL</span>;
        <span style="color:#66d9ef">goto</span> LABEL_13;
      }
    }
    sub_410CC0(<span style="color:#e6db74">&#34;continue!&#34;</span>);
</code></pre></div><p>写一个python脚本迭代出假flag：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data <span style="color:#f92672">=</span> []
v12 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Iodl&gt;Qnb(ocy&#34;</span>
insert_v <span style="color:#f92672">=</span> <span style="color:#ae81ff">127</span>;
v13 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;y.i&#34;</span>
v14 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;d`3w}wek9{iy=~yL@EC&#34;</span>
flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> v12:
    data<span style="color:#f92672">.</span>append(ord(i))
data<span style="color:#f92672">.</span>append(insert_v)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> v13:
    data<span style="color:#f92672">.</span>append(ord(i))
data<span style="color:#f92672">.</span>append(insert_v)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> v14:
    data<span style="color:#f92672">.</span>append(ord(i))

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">36</span>):
    flag <span style="color:#f92672">+=</span>chr(data[i]<span style="color:#f92672">^</span>i)

print(flag)
</code></pre></div><p>运行脚本得到fake flag：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">Info:The first four chars are `flag`
</code></pre></div><p>然后走进下面一个坑：</p>
<p>（”吾愿称之为base64之坑“ XD ）</p>
<p><img src="/images/BUUCTF-REVERSE-%5B17-24%5D_writeup/image-20210918163713879.png" alt="image-20210918163713879"></p>
<p>提取数据：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">Vm0wd2VHUXhTWGhpUm1SWVYwZDRWVll3Wkc5WFJsbDNXa1pPVlUxV2NIcFhhMk0xVmpKS1NHVkdXbFpOYmtKVVZtcEtTMUl5VGtsaVJtUk9ZV3hhZVZadGVHdFRNVTVYVW01T2FGSnRVbGhhVjNoaFZWWmtWMXBFVWxSTmJFcElWbTAxVDJGV1NuTlhia0pXWWxob1dGUnJXbXRXTVZaeVdrWm9hVlpyV1hwV1IzaGhXVmRHVjFOdVVsWmlhMHBZV1ZSR1lWZEdVbFZTYlhSWFRWWndNRlZ0TVc5VWJGcFZWbXR3VjJKSFVYZFdha1pXWlZaT2NtRkhhRk5pVjJoWVYxZDBhMVV3TlhOalJscFlZbGhTY1ZsclduZGxiR1J5VmxSR1ZXSlZjRWhaTUZKaFZqSktWVkZZYUZkV1JWcFlWV3BHYTFkWFRrZFRiV3hvVFVoQ1dsWXhaRFJpTWtsM1RVaG9hbEpYYUhOVmJUVkRZekZhY1ZKcmRGTk5Wa3A2VjJ0U1ExWlhTbFpqUldoYVRVWndkbFpxUmtwbGJVWklZVVprYUdFeGNHOVhXSEJIWkRGS2RGSnJhR2hTYXpWdlZGVm9RMlJzV25STldHUlZUVlpXTlZadE5VOVdiVXBJVld4c1dtSllUWGhXTUZwell6RmFkRkpzVWxOaVNFSktWa1phVTFFeFduUlRhMlJxVWxad1YxWnRlRXRXTVZaSFVsUnNVVlZVTURrPQ==
</code></pre></div><p>进行十次base64解密得到一个博客地址：https://bbs.pediy.com/thread-254172.htm</p>
<p>点开博客看一下，可以看到这段话：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">
所谓“让对手不要走正确的破解之路” 

讲人话 就是“把对手往沟里带” 

但对手并不傻 很多时候攻击方比防守方更聪明 

要想带对手进沟 防守方必须首先透彻了解攻击方 特别是其人性弱点（知道为什么是马克思主义学院了吧） 
</code></pre></div><p>Good, 现在知道自己掉坑里面了， 两个坑都掉了一遍所以flag在哪呢？</p>
<p>我们去找下主函数</p>
<p><img src="/images/BUUCTF-REVERSE-%5B17-24%5D_writeup/image-20210918173639284.png" alt="image-20210918173639284"></p>
<p>发现周围存在一个奇奇怪怪的函数，会不会就是这个函数呢</p>
<p>点开看看：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int64</span> <span style="color:#a6e22e">sub_400D35</span>()
{
  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int64</span> result; <span style="color:#75715e">// rax
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> v1; <span style="color:#75715e">// [rsp+Ch] [rbp-24h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// [rsp+10h] [rbp-20h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> j; <span style="color:#75715e">// [rsp+14h] [rbp-1Ch]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> v4; <span style="color:#75715e">// [rsp+24h] [rbp-Ch]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int64</span> v5; <span style="color:#75715e">// [rsp+28h] [rbp-8h]
</span><span style="color:#75715e"></span>
  v5 <span style="color:#f92672">=</span> __readfsqword(<span style="color:#ae81ff">0x28u</span>);
  v1 <span style="color:#f92672">=</span> sub_43FD20(<span style="color:#ae81ff">0LL</span>) <span style="color:#f92672">-</span> qword_6CEE38;
  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1233</span>; <span style="color:#f92672">++</span>i )
  {
    sub_40F790(v1);
    sub_40FE60();
    sub_40FE60();
    v1 <span style="color:#f92672">=</span> sub_40FE60() <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x98765432</span>;
  }
  v4 <span style="color:#f92672">=</span> v1;
  <span style="color:#66d9ef">if</span> ( ((<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)v1 <span style="color:#f92672">^</span> byte_6CC0A0[<span style="color:#ae81ff">0</span>]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">102</span> <span style="color:#f92672">&amp;&amp;</span> (HIBYTE(v4) <span style="color:#f92672">^</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)byte_6CC0A3) <span style="color:#f92672">==</span> <span style="color:#ae81ff">103</span> )
  {
    <span style="color:#66d9ef">for</span> ( j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">24</span>; <span style="color:#f92672">++</span>j )
      sub_410E90((<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)(byte_6CC0A0[j] <span style="color:#f92672">^</span> <span style="color:#f92672">*</span>((_BYTE <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v4 <span style="color:#f92672">+</span> j <span style="color:#f92672">%</span> <span style="color:#ae81ff">4</span>)));
  }
  result <span style="color:#f92672">=</span> __readfsqword(<span style="color:#ae81ff">0x28u</span>) <span style="color:#f92672">^</span> v5;
  <span style="color:#66d9ef">if</span> ( result )
    sub_444020();
  <span style="color:#66d9ef">return</span> result;
}
</code></pre></div><p>应该就是简单的异或操作了，需要提取数据来进行异或来得到flag</p>
<p>提取数据并写一个异或脚本就就可以得到flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data <span style="color:#f92672">=</span> [
  <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0x5D</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x2F</span>, 
  <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x6E</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0x3C</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x6C</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x6E</span>, 
  <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x3C</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x5B</span>
  ]
s <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;flag&#34;</span>
key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
    key <span style="color:#f92672">+=</span> chr(ord(s[i])<span style="color:#f92672">^</span>data[i])

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(data)):
    flag <span style="color:#f92672">+=</span> chr(data[i]<span style="color:#f92672">^</span>ord(key[i<span style="color:#f92672">%</span><span style="color:#ae81ff">4</span>]))

print(flag)
</code></pre></div><p>运行脚本就能得到flag，终于是over了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">flag{Act1ve_Defen5e_Test}
</code></pre></div><h2 id="0x5-actf新生赛2020-rome">0x5 [ACTF新生赛2020] rome</h2>
<p>首先，查一下文件的信息</p>
<p><img src="/images/BUUCTF-REVERSE-%5B17-24%5D_writeup/image-20210919081555684.png" alt="image-20210919081555684"></p>
<p>32位程序，没有壳，丢进IDA prio里面看看：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">func</span>()
{
  <span style="color:#66d9ef">int</span> result; <span style="color:#75715e">// eax
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v1[<span style="color:#ae81ff">4</span>]; <span style="color:#75715e">// [esp+14h] [ebp-44h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span> v2; <span style="color:#75715e">// [esp+24h] [ebp-34h] BYREF
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span> v3; <span style="color:#75715e">// [esp+25h] [ebp-33h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span> v4; <span style="color:#75715e">// [esp+26h] [ebp-32h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span> v5; <span style="color:#75715e">// [esp+27h] [ebp-31h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span> v6; <span style="color:#75715e">// [esp+28h] [ebp-30h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v7; <span style="color:#75715e">// [esp+29h] [ebp-2Fh]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v8; <span style="color:#75715e">// [esp+2Dh] [ebp-2Bh]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v9; <span style="color:#75715e">// [esp+31h] [ebp-27h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v10; <span style="color:#75715e">// [esp+35h] [ebp-23h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span> v11; <span style="color:#75715e">// [esp+39h] [ebp-1Fh]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v12[<span style="color:#ae81ff">29</span>]; <span style="color:#75715e">// [esp+3Bh] [ebp-1Dh] BYREF
</span><span style="color:#75715e"></span>
  strcpy(v12, <span style="color:#e6db74">&#34;Qsw3sj_lz4_Ujw@l&#34;</span>);
  printf(<span style="color:#e6db74">&#34;Please input:&#34;</span>);
  scanf(<span style="color:#e6db74">&#34;%s&#34;</span>, <span style="color:#f92672">&amp;</span>v2);
  result <span style="color:#f92672">=</span> v2;
  <span style="color:#66d9ef">if</span> ( v2 <span style="color:#f92672">==</span> <span style="color:#ae81ff">65</span> )
  {
    result <span style="color:#f92672">=</span> v3;
    <span style="color:#66d9ef">if</span> ( v3 <span style="color:#f92672">==</span> <span style="color:#ae81ff">67</span> )
    {
      result <span style="color:#f92672">=</span> v4;
      <span style="color:#66d9ef">if</span> ( v4 <span style="color:#f92672">==</span> <span style="color:#ae81ff">84</span> )
      {
        result <span style="color:#f92672">=</span> v5;
        <span style="color:#66d9ef">if</span> ( v5 <span style="color:#f92672">==</span> <span style="color:#ae81ff">70</span> )
        {
          result <span style="color:#f92672">=</span> v6;
          <span style="color:#66d9ef">if</span> ( v6 <span style="color:#f92672">==</span> <span style="color:#ae81ff">123</span> )
          {
            result <span style="color:#f92672">=</span> v11;
            <span style="color:#66d9ef">if</span> ( v11 <span style="color:#f92672">==</span> <span style="color:#ae81ff">125</span> )
            {
              v1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> v7;
              v1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> v8;
              v1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> v9;
              v1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> v10;
              <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
              <span style="color:#66d9ef">while</span> ( <span style="color:#f92672">*</span>(<span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">15</span> )
              {
                <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">*</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)v1 <span style="color:#f92672">+</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>]) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">64</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">*</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)v1 <span style="color:#f92672">+</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>]) <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">90</span> )
                  <span style="color:#f92672">*</span>((_BYTE <span style="color:#f92672">*</span>)v1 <span style="color:#f92672">+</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>]) <span style="color:#f92672">=</span> (<span style="color:#f92672">*</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)v1 <span style="color:#f92672">+</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>]) <span style="color:#f92672">-</span> <span style="color:#ae81ff">51</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">65</span>;
                <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">*</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)v1 <span style="color:#f92672">+</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>]) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">96</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">*</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)v1 <span style="color:#f92672">+</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>]) <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">122</span> )
                  <span style="color:#f92672">*</span>((_BYTE <span style="color:#f92672">*</span>)v1 <span style="color:#f92672">+</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>]) <span style="color:#f92672">=</span> (<span style="color:#f92672">*</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)v1 <span style="color:#f92672">+</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>]) <span style="color:#f92672">-</span> <span style="color:#ae81ff">79</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">97</span>;
                <span style="color:#f92672">++*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>];
              }
              <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
              <span style="color:#66d9ef">while</span> ( <span style="color:#f92672">*</span>(<span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">15</span> )
              {
                result <span style="color:#f92672">=</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)v12[<span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>]];
                <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">*</span>((_BYTE <span style="color:#f92672">*</span>)v1 <span style="color:#f92672">+</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>]) <span style="color:#f92672">!=</span> (_BYTE)result )
                  <span style="color:#66d9ef">return</span> result;
                <span style="color:#f92672">++*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v12[<span style="color:#ae81ff">17</span>];
              }
              result <span style="color:#f92672">=</span> printf(<span style="color:#e6db74">&#34;You are correct!&#34;</span>);
            }
          }
        }
      }
    }
  }
  <span style="color:#66d9ef">return</span> result;
}
</code></pre></div><p>对代码进行简单的审计，可以发现，程序的加密算法是类似与凯撒加密的位移方式，可以根据程序的这一特点写个Python脚本进行求解来得到flag的数据：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> string

data <span style="color:#f92672">=</span> [<span style="color:#ae81ff">81</span>,<span style="color:#ae81ff">115</span>,<span style="color:#ae81ff">119</span>,<span style="color:#ae81ff">51</span>,<span style="color:#ae81ff">115</span>,<span style="color:#ae81ff">106</span>,<span style="color:#ae81ff">95</span>,<span style="color:#ae81ff">108</span>,<span style="color:#ae81ff">122</span>,<span style="color:#ae81ff">52</span>,<span style="color:#ae81ff">95</span>,<span style="color:#ae81ff">85</span>,<span style="color:#ae81ff">106</span>,<span style="color:#ae81ff">119</span>,<span style="color:#ae81ff">64</span>,<span style="color:#ae81ff">108</span>]

Lower <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_lowercase
Upper <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_uppercase

flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> data:
    <span style="color:#66d9ef">if</span> i <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">64</span> <span style="color:#f92672">and</span> i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">90</span>:
        flag <span style="color:#f92672">+=</span> Upper[i<span style="color:#f92672">-</span><span style="color:#ae81ff">14</span><span style="color:#f92672">-</span><span style="color:#ae81ff">65</span>]
    <span style="color:#66d9ef">elif</span> i <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">96</span> <span style="color:#f92672">and</span> i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">122</span>:
        flag <span style="color:#f92672">+=</span> Lower[i<span style="color:#f92672">-</span><span style="color:#ae81ff">18</span><span style="color:#f92672">-</span><span style="color:#ae81ff">97</span>]
    <span style="color:#66d9ef">else</span>:
        flag <span style="color:#f92672">+=</span> chr(i)
print (<span style="color:#e6db74">&#39;flag{&#39;</span><span style="color:#f92672">+</span>flag<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;}&#39;</span>)
</code></pre></div><p>运行脚本，得到flag：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">flag{Cae3ar_th4_Gre@t}
</code></pre></div><h2 id="0x6-flareon4-login">0x6 [FlareOn4] login</h2>
<p>发现文件是一个html文件，应该是需要进行源码阅读的题目，然后逆向算法</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!DOCTYPE Html /&gt;</span>
&lt;<span style="color:#f92672">html</span>&gt;

&lt;<span style="color:#f92672">head</span>&gt;
    &lt;<span style="color:#f92672">title</span>&gt;FLARE On 2017&lt;/<span style="color:#f92672">title</span>&gt;
&lt;/<span style="color:#f92672">head</span>&gt;

&lt;<span style="color:#f92672">body</span>&gt;
    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;flag&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;flag&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Enter the flag&#34;</span> /&gt;
    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;button&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;prompt&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Click to check the flag&#34;</span> /&gt;
    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span>&gt;
        document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;prompt&#34;</span>).<span style="color:#a6e22e">onclick</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> () {
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">flag</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;flag&#34;</span>).<span style="color:#a6e22e">value</span>;
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">rotFlag</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/[a-zA-Z]/g</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">c</span>) { 
                <span style="color:#66d9ef">return</span> String.<span style="color:#a6e22e">fromCharCode</span>((<span style="color:#a6e22e">c</span> <span style="color:#f92672">&lt;=</span> <span style="color:#e6db74">&#34;Z&#34;</span> <span style="color:#f92672">?</span> <span style="color:#ae81ff">90</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">122</span>) <span style="color:#f92672">&gt;=</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">13</span>) <span style="color:#f92672">?</span> <span style="color:#a6e22e">c</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">c</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">26</span>); 
            });
            <span style="color:#66d9ef">if</span> (<span style="color:#e6db74">&#34;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&#34;</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">rotFlag</span>) {
                <span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">&#34;Correct flag!&#34;</span>);
            } <span style="color:#66d9ef">else</span> {
                <span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">&#34;Incorrect flag, rot again&#34;</span>);
            }
        }
    &lt;/<span style="color:#f92672">script</span>&gt;
&lt;/<span style="color:#f92672">body</span>&gt;

&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><p>源码的核心逻辑是在JavaScript的代码中，看来题目要求我们可以能够对算法进行逆向分析，来得到flag数据</p>
<p>代码进行的操作无非就是±13的操作。</p>
<p>代码会区分大小写分别进行相应的操作来得到flag，如果字母+13小于字母表最后一位字母，字母最终就+13，否则字母最终就-13。逻辑非常简单，写个简单的逆向算法就能进行求解：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cipher <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&#34;</span>
m <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> cipher:
    <span style="color:#66d9ef">if</span> ord(i) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">65</span> <span style="color:#f92672">and</span> ord(i) <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">90</span>:
        <span style="color:#66d9ef">if</span> ord(i)<span style="color:#f92672">-</span><span style="color:#ae81ff">13</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">65</span>:
            m <span style="color:#f92672">+=</span> chr(ord(i)<span style="color:#f92672">+</span><span style="color:#ae81ff">13</span>)
        <span style="color:#66d9ef">else</span>:
            m <span style="color:#f92672">+=</span> chr(ord(i)<span style="color:#f92672">-</span><span style="color:#ae81ff">13</span>)
    <span style="color:#66d9ef">elif</span> ord(i) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">97</span> <span style="color:#f92672">and</span> ord(i) <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">122</span>:
        <span style="color:#66d9ef">if</span> ord(i)<span style="color:#f92672">-</span><span style="color:#ae81ff">13</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">97</span>:
            m <span style="color:#f92672">+=</span> chr(ord(i)<span style="color:#f92672">+</span><span style="color:#ae81ff">13</span>)
        <span style="color:#66d9ef">else</span>:
            m <span style="color:#f92672">+=</span> chr(ord(i)<span style="color:#f92672">-</span><span style="color:#ae81ff">13</span>)
    <span style="color:#66d9ef">else</span>:
        m <span style="color:#f92672">+=</span> i

print(m)
</code></pre></div><p>运行脚本，就能得到flag：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">ClientSideLoginsAreEasy@flare-on.com
</code></pre></div><p>唔~题目好像还有个hint可以看一下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">Hint:本题解出相应字符串后请用flag{}包裹，形如：flag{123456@flare-on.com}
</code></pre></div><p>所以，这道题目的flag应该就是：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">flag{ClientSideLoginsAreEasy@flare-on.com}
</code></pre></div><h2 id="0x7-guet-ctf2019-re">0x7 [GUET-CTF2019] re</h2>
<p>拿到程序，先看看程序的信息：</p>
<p><img src="/images/BUUCTF-REVERSE-%5B17-24%5D_writeup/image-20210919092405673.png" alt="image-20210919092405673"></p>
<p>发现程序有壳，而且是一个64位的ELF程序</p>
<p>需要进行脱壳处理，程序使用的是最基本的UPX的壳，可以使用UPX进行简单脱壳：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">upx -d re
</code></pre></div><p>脱壳后，然后使用Exeinfo再次进行查看</p>
<p><img src="/images/BUUCTF-REVERSE-%5B17-24%5D_writeup/image-20210919092939620.png" alt="image-20210919092939620"></p>
<p>壳已经被脱掉，然后使用x64 IDA pro进行查看程序</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">// positive sp value has been detected, the output may be wrong!
</span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#66d9ef">__fastcall</span> __noreturn <span style="color:#a6e22e">start</span>(<span style="color:#66d9ef">__int64</span> a1, <span style="color:#66d9ef">__int64</span> a2, <span style="color:#66d9ef">int</span> a3)
{
  <span style="color:#66d9ef">__int64</span> v3; <span style="color:#75715e">// rax
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v4; <span style="color:#75715e">// esi
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v5; <span style="color:#75715e">// [rsp-8h] [rbp-8h] BYREF
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>retaddr; <span style="color:#75715e">// [rsp+0h] [rbp+0h] BYREF
</span><span style="color:#75715e"></span>
  v4 <span style="color:#f92672">=</span> v5;
  v5 <span style="color:#f92672">=</span> v3;
  sub_4016C0(
    (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)sub_400E28,
    v4,
    (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)<span style="color:#f92672">&amp;</span>retaddr,
    (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)sub_401B80,
    (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)sub_401C10,
    a3,
    (<span style="color:#66d9ef">__int64</span>)<span style="color:#f92672">&amp;</span>v5);
}
</code></pre></div><p>发现程序入口并找不到什么东西，应该是将入口函数进行混淆和隐藏了</p>
<p>使用字符串检索来获取相应的信息，来定位到主函数：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">__int64</span> <span style="color:#66d9ef">__fastcall</span> <span style="color:#a6e22e">sub_400E28</span>(<span style="color:#66d9ef">__int64</span> a1, <span style="color:#66d9ef">int</span> a2, <span style="color:#66d9ef">int</span> a3, <span style="color:#66d9ef">int</span> a4, <span style="color:#66d9ef">int</span> a5, <span style="color:#66d9ef">int</span> a6)
{
  <span style="color:#66d9ef">int</span> v6; <span style="color:#75715e">// edx
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v7; <span style="color:#75715e">// ecx
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v8; <span style="color:#75715e">// er8
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v9; <span style="color:#75715e">// er9
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> result; <span style="color:#75715e">// rax
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v11; <span style="color:#75715e">// [rsp+0h] [rbp-30h] BYREF
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int64</span> v12; <span style="color:#75715e">// [rsp+28h] [rbp-8h]
</span><span style="color:#75715e"></span>
  v12 <span style="color:#f92672">=</span> __readfsqword(<span style="color:#ae81ff">0x28u</span>);
  sub_40F950((<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)<span style="color:#e6db74">&#34;input your flag:&#34;</span>, a2, a3, a4, a5, a6, <span style="color:#ae81ff">0LL</span>, <span style="color:#ae81ff">0LL</span>, <span style="color:#ae81ff">0LL</span>, <span style="color:#ae81ff">0LL</span>);
  sub_40FA80((<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)<span style="color:#e6db74">&#34;%s&#34;</span>, (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)<span style="color:#f92672">&amp;</span>v11, v6, v7, v8, v9, v11);
  <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)sub_4009AE(<span style="color:#f92672">&amp;</span>v11) )
    sub_410350(<span style="color:#e6db74">&#34;Correct!&#34;</span>);
  <span style="color:#66d9ef">else</span>
    sub_410350(<span style="color:#e6db74">&#34;Wrong!&#34;</span>);
  result <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( __readfsqword(<span style="color:#ae81ff">0x28u</span>) <span style="color:#f92672">!=</span> v12 )
    sub_443550();
  <span style="color:#66d9ef">return</span> result;
}
</code></pre></div><p>主函数中的一些关键性的函数都被进行了混淆操作，代码进行审计分析</p>
<p>v11是关键输入函数，然后<code>sub_40FA80</code>是关键性的函数，对<code>sub_40FA80</code>分析：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">_BOOL8 <span style="color:#66d9ef">__fastcall</span> <span style="color:#a6e22e">sub_4009AE</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>a1)
{
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">1629056</span> <span style="color:#f92672">*</span> <span style="color:#f92672">*</span>a1 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">166163712</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">6771600</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">731332800</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">3682944</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">357245568</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">10431000</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1074393000</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">3977328</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">489211344</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">5138336</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">518971936</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">7532250</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">406741500</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">5551632</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">294236496</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">3409728</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">177305856</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">13013670</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">650683500</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">6088797</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">298351053</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">7884663</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">386348487</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">8944053</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">438258597</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">5198490</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">249527520</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">4544518</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">445362764</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">3645600</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">174988800</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">10115280</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">981182160</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">9667504</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">493042704</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">5364450</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">257493600</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">13464540</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">767478780</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">5488432</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">312840624</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">14479500</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1404511500</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">6451830</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">316139670</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">6252576</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">619005024</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">7763364</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">25</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">372641472</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">7327320</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">26</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">373693320</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">8741520</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">498266640</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">8871876</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">452465676</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">4086720</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">29</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">208422720</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#ae81ff">9374400</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">515592000</span> )
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">5759124</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">719890500</span>;
  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
}
</code></pre></div><p>写个C语言的flag生成器来生成flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
{
  <span style="color:#66d9ef">char</span> a1[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
  <span style="color:#f92672">*</span>a1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">166163712</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">1629056</span>;
  a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">731332800</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">6771600</span>;
  a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">357245568</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">3682944</span>;
  a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1074393000</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">10431000</span>;
  a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">489211344</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">3977328</span>;
  a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">518971936</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">5138336</span>;
  a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">406741500</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">7532250</span>;
  a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">294236496</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">5551632</span>;
  a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">177305856</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">3409728</span>;
  a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">650683500</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">13013670</span>;
  a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">298351053</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">6088797</span>;
  a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">386348487</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">7884663</span>;
  a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">438258597</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">8944053</span>;
  a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">249527520</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">5198490</span>;
  a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">445362764</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">4544518</span>;
  a1[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">174988800</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">3645600</span>;
  a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">981182160</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">10115280</span>;
  a1[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">493042704</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">9667504</span>;
  a1[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">257493600</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">5364450</span>;
  a1[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">767478780</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">13464540</span>;
  a1[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">312840624</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">5488432</span>;
  a1[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1404511500</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">14479500</span>;
  a1[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">316139670</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">6451830</span>;
  a1[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">619005024</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">6252576</span>;
  a1[<span style="color:#ae81ff">25</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">372641472</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">7763364</span>;
  a1[<span style="color:#ae81ff">26</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">373693320</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">7327320</span>;
  a1[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">498266640</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">8741520</span>;
  a1[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">452465676</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">8871876</span>;
  a1[<span style="color:#ae81ff">29</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">208422720</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">4086720</span>;
  a1[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">515592000</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">9374400</span>;
  a1[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">719890500</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">5759124</span>;
  <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">32</span>;<span style="color:#f92672">++</span>i)
    {
      <span style="color:#66d9ef">if</span>(a1[i] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) printf(<span style="color:#e6db74">&#34;*&#34;</span>);
      <span style="color:#66d9ef">else</span> printf(<span style="color:#e6db74">&#34;%c&#34;</span>,a1[i]);
    }
  printf(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
}
</code></pre></div><p>编译并运行来得到flag：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">flag{e*65421110ba03099a1c039337}
</code></pre></div><p>由于有一位的字符未知，需要进行爆破来得到flag:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">flag{e165421110ba03099a1c039337}
</code></pre></div>
      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://zcodetea.github.io/tags/ctf/">CTF</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        2555 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2022-01-28 19:24
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fzcodetea.github.io%2fposts%2fbuuctf-reverse-17-24-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fzcodetea.github.io%2fposts%2fbuuctf-reverse-17-24-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=BUUCTF%20REVERSE%20%5b17%2024%5d%20Writeup&amp;caption=BUUCTF%20REVERSE%20%5b17%2024%5d%20Writeup&amp;canonicalUrl=https%3a%2f%2fzcodetea.github.io%2fposts%2fbuuctf-reverse-17-24-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=BUUCTF%20REVERSE%20%5b17%2024%5d%20Writeup&amp;body=https%3a%2f%2fzcodetea.github.io%2fposts%2fbuuctf-reverse-17-24-writeup%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fzcodetea.github.io%2fposts%2fbuuctf-reverse-17-24-writeup%2f&amp;media=https%3a%2f%2fzcodetea.github.io%2fposts%2fbuuctf-reverse-17-24-writeup%2f;description=BUUCTF%20REVERSE%20%5b17%2024%5d%20Writeup" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fzcodetea.github.io%2fposts%2fbuuctf-reverse-17-24-writeup%2f&amp;title=BUUCTF%20REVERSE%20%5b17%2024%5d%20Writeup&amp;summary=BUUCTF%20REVERSE%20%5b17%2024%5d%20Writeup&amp;source=https%3a%2f%2fzcodetea.github.io%2fposts%2fbuuctf-reverse-17-24-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2fzcodetea.github.io%2fposts%2fbuuctf-reverse-17-24-writeup%2f&amp;resubmit=true&amp;title=BUUCTF%20REVERSE%20%5b17%2024%5d%20Writeup" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fzcodetea.github.io%2fposts%2fbuuctf-reverse-17-24-writeup%2f;title=BUUCTF%20REVERSE%20%5b17%2024%5d%20Writeup" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=BUUCTF%20REVERSE%20%5b17%2024%5d%20Writeup%20https%3a%2f%2fzcodetea.github.io%2fposts%2fbuuctf-reverse-17-24-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fzcodetea.github.io%2fposts%2fbuuctf-reverse-17-24-writeup%2f&amp;t=BUUCTF%20REVERSE%20%5b17%2024%5d%20Writeup" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=BUUCTF%20REVERSE%20%5b17%2024%5d%20Writeup&amp;url=https%3a%2f%2fzcodetea.github.io%2fposts%2fbuuctf-reverse-17-24-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
    <div class="pagination">
        <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
        </div>

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="https://zcodetea.github.io/posts/xctf-reverse-expert-1-6-writeup/">
                    <span class="button__icon">←</span>
                    <span class="button__text">XCTF REVERSE Expert [1~6] Writeup</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="https://zcodetea.github.io/posts/buuctf-reverse-9-16-writeup/">
                    <span class="button__text">BUUCTF REVERSE [9~16] Writeup</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

  </main>

            </div>

            
                <footer class="footer">
    
    
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.599099f1f14b78b657d524b28e10e0c5098e7cd46e9c7aed73d577068a276c3ff1bb234cbf29cb313333e83cf411727b43157c91ce5b809e2ffc81664614608e.js" integrity="sha512-WZCZ8fFLeLZX1SSyjhDgxQmOfNRunHrtc9V3BoonbD/xuyNMvynLMTMz6Dz0EXJ7QxV8kc5bgJ4v/IFmRhRgjg=="></script>



    </body>
</html>
