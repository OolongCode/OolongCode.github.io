---
title: "BUUCTF CRYPTO [64~80]_writeup"
date: 2021-07-01T10:14:15+08:00
draft: false
tag: ctf
toc: true
math: true
---

# BUUCTF-CRYPTO-[65-80] writeup

å¯†ç å­¦ç™¾é¢˜è®¡åˆ’å¯åŠ¨ï¼è¿›è¡Œå‹‡å¾€ç›´å‰ï¼

![image-20210628200701835](/images/BUUCTF-CRYPTO-[64-80]_writeup/image-20210628200701835.png)

æœ¬æ¬¡çš„16é“é¢˜ç›®ï¼Œä¹Ÿæ˜¯éå¸¸æœ‰æ„æ€çš„å‘¢ï¼å„ç§å„æ ·çš„å‘¢â€¦â€¦

![image-20210628200448759](/images/BUUCTF-CRYPTO-[64-80]_writeup/image-20210628200448759.png)

## 0x0 æµªé‡Œæ·˜æ²™ 

çœ‹æ ·å­ï¼Œåº”è¯¥æ˜¯ä¸ªè„‘æ´é¢˜æ²¡é”™äº†

æ¥åº·åº·è¿™é¢˜çš„é¢˜ç›®ï¼š

```txt
æˆ‘æœ‰å¯†é›†ææƒ§ç—‡ï¼Œæ‰€ä»¥å¤§å®¶è‡ªæ±‚å¤šç¦å§ï¼ŒæŠŠè·å¾—çš„å•è¯è¿åœ¨ä¸€èµ·æäº¤å³å¯ã€‚ï¼ˆæˆ‘è¿™é‡Œæœ‰ä¸€ä¸²æ•°å­—ï¼š4ï¼Œ8ï¼Œ11ï¼Œ15ï¼Œ16ï¼‰ æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤
```

è¿™é¢˜ç›®å¥½åƒæœ‰ç‚¹æ„æ€ï¼Œå¯ä»¥ä»é¢˜ç›®ä¸­æç‚¼ä¸€äº›ä¿¡æ¯ï¼š

1. å¯†é›†ææƒ§ç—‡
2. è·å¾—çš„å•è¯è¿åœ¨ä¸€èµ·æäº¤
3. æˆ‘è¿™é‡Œæœ‰ä¸€ä¸²æ•°å­—ï¼š4ï¼Œ8ï¼Œ11ï¼Œ15ï¼Œ16

æ ¹æ®æç‚¼çš„æ•°æ®è¿›è¡Œåˆ†äº«ï¼Œåº”è¯¥æ˜¯è¯é¢‘ç»Ÿè®¡ç±»çš„é¢˜ç›®ï¼Œè¿™é¢˜æœ‰ç‚¹æ„æ€

çœ‹çœ‹é™„ä»¶æ˜¯å•¥å§ï¼š

```txt
tonightsuccessnoticenoticewewesuccesstonightweexamplecryptoshouldwebackspacetonightbackspaceexamplelearnwesublimlearnbackspacetheshouldwelearnfoundsublimsystemexamplesublimfoundlearnshouldmorningsublimsystemuserlearnthecryptomorningexamplenoticetonightlearntonightlearntonightsublimenterusermorningfoundtonightweenterfoundnoticethecryptomorningthebackspacelearntonightlearnsublimtonightlearnfoundenterfoundsuccesstonightsuccessuserfoundmorningtonighttheshouldsublimentertonightenterbackspacelearnexamplenoticeexamplefoundsystemsuccesssublimsuccessshouldtonightcryptowelearncryptofoundshouldsublimsublimweentertonightsuccessshouldentertheentercryptouserbackspaceshouldentersystemsuccesssystementerfoundenterlearnexampletonightnoticemorningusertonightlearnmorningtonightfoundfoundsuccessnoticesystementerlearnexamplebackspaceshouldcryptocryptosublimweexampletonighttheshouldthemorningbackspacelearntonightsystemsuccesssuccessbackspacemorningnoticeuserfoundfoundtonightmorningenterenterthefoundbackspacelearnenterentershouldthesystemfounduserlearnlearnsystemnoticetonighttheshouldlearnuserbackspaceweusernoticeshouldthewefoundsystemwecryptocryptowethebackspacesystementershouldtonightsystemnoticemorningsystemweentermorningfoundsuccessusertonightsuccesstonightbackspaceshouldweenterthewesystemusernoticesystemthelearnexamplelearnfoundlearnnoticeexamplesystemthecryptocryptolearnsystemthecryptoenterlearnexamplemorningmorningweenterentersuccessexampleuserthebackspacenoticesublimenterbackspacesuccessbackspacethesublimexamplesystemtheexamplecryptolearnuserexamplelearnsystemusersuccessenterentersuccesstheuserbackspacelearnsuccessbackspacethesublimshouldwebackspaceexamplesuccesssuccesstonightweusershouldsuccessmorningcryptomorningfoundbackspacesublimshouldentershouldnoticesuccessmorningsuccessexamplelearnshouldsublimlearntonightshoulduserbackspacesublimlearncryptosuccessenternoticetonightmorningtonightwesuccessweuserbackspaceexamplewesystemnoticemorningsystemmorningcryptolearnsystemthethefoundcryptouserlearnusersystemwemorningenterexampleshouldlearncryptofoundenterbackspacelearnenterenterbackspaceshouldbackspacetheshouldthesystemshouldshouldsuccessmorningthefoundsystementersystemtonightcryptowelearnexampleexamplesystementerbackspaceshouldtheentersublimtonightfoundfoundsuccesssuccesssystemsublimcryptoshouldentersublimmorninglearnfoundtonightcryptobackspacesuccesscryptowebackspacefoundshouldnoticeshouldmorningnoticesystemcryptosystemlearnsystemnoticemorningsystementerwemorninglearnsuccessfoundwesuccesswetheusercryptousernoticebackspacesuccessshouldtonightmorningentermorninguserenternoticefoundmorningwetonightsystemthecryptotonightcryptosystemuserthefoundexampletonightusersystemcryptosublimmorninguserthefoundbackspaceshouldsuccesscryptotonightsystemnoticebackspaceusershouldenterthecryptomorningwesublimnoticesuccessnoticeusersuccesstonightlearnweuserenterfounduserexampleshouldshouldtonightwelearnthenoticethewefoundmorningexampleshouldexamplethesuccessnoticeenterfoundthecryptonoticeuserlearnuserweenterfoundmorningsystemweexamplenoticethebackspaceexamplesublimtheusermorningtonightthesuccesscryptosuccessusersuccesstonighttonightwelearnenterenterthemorningentersystemcryptobackspacemorningsystemexamplecryptouserexamplelearnsublimsuccessusersystemfoundmorningshouldcryptotonightsublimtheexamplemorningsystemuserexampleweexamplenoticesuccesssublimnoticecryptoshouldbackspaceshouldthetonightfoundsublimbackspacebackspacetonightshouldbackspacesuccesstonightbackspacesuccessmorningsystemcryptobackspaceentertonighttonightnoticelearnshoulduserfoundexamplesystemthesuccessweusertonightcryptousernoticeenternoticebackspaceusersystemfoundusernoticeshouldlearnuserfoundexampleusermorningshouldsuccessmorningmorningexampleexamplefoundsublimfoundenterbackspacenoticelearnfoundmorningcryptonoticecryptoshouldweshouldtonightcryptobackspacesublimcryptosublimenterentersublimentercryptonoticethethesublimexampleenterentershouldlearncryptoentershouldmorninglearnnoticeuserexamplesublimtonightshouldfoundtonightsuccessshouldmorningfoundtheweuserlearnsublimsystembackspacecryptotheusertonightcryptosublimmorningmorningexamplenoticetheenterlearnshouldmorningsublimfoundtonightsublimsublimexamplefounduserexamplethefoundwemorningnoticefoundcryptosuccesssublimsublimexamplethesuccessexamplenoticesuccessbackspacesublimlearnuserexamplesuccesssuccesssystemsuccessmorningmorninglearnexamplemorningtonightfoundbackspaceenternoticemorningentersuccessmorningusermorningbackspacelearncryptoenteruserenteruserthetonighttonightsuccesslearnenterfoundsuccesssystemfoundbackspaceenterlearnsystemsublimcryptoentermorningwetonightshouldlearnenterfoundcryptonoticelearnlearnshouldfoundsuccessexampletonightthesuccessfoundusertonightenterfoundsuccessshouldmorningusernoticemorningsystemsystemsuccessshouldwelearnenterfoundexamplewethefoundweshouldsystemsystemmorningmorningbackspaceshouldentersublimentertonightsuccesssystemsystemcryptousershouldsublimfoundwetonightnoticeexamplewewesuccessfoundusertonightfoundsystemexamplecryptofoundshouldshouldsuccessenterbackspaceexampletonightthelearnnoticeuserlearnsystemsublimfoundlearnsuccesssystemshouldsublimnoticelearnsystemnoticetonightexamplefoundusernoticeenterlearnnoticecryptousersystemmorningthewesystemfoundfoundshouldsystementerenterbackspacesystemsublimcryptousermorninglearnlearntonightsublimlearnenterenterbackspacesystemuserusercryptoentershouldtheusersublimnoticeexamplemorningexamplesublimsublimbackspacesystemexampleshouldsublimlearnfoundenterbackspacelearnmorningmorningfoundthetonightmorningnoticeenterlearnusersystemtonightbackspaceexamplelearntonightbackspaceweshouldcryptosuccessbackspaceexamplesuccesstheshouldmorninguserbackspacelearnthetheshouldcryptocryptotonightbackspacecryptocryptobackspacebackspacenoticeusertonightentermorningfoundweenterexampleenterfoundusersublimsystemtheexampleexamplesystemsuccessusersublimentermorningbackspacesystemfoundlearnsystemshouldsublimsublimentershouldtheusershouldexampleexampleshouldsuccesswelearnfoundsublimshoulduserweentertonightwenoticesublimsystemlearnshouldfoundsuccessuserentersuccessmorningcryptoenteruserfoundexampletonightlearnexampleexamplefoundlearnsuccesssystembackspacecryptonoticethefoundbackspacelearncryptothelearnlearnexamplesuccessnoticenoticesystemmorningcryptotonightnoticenoticeentersuccesscryptoenterbackspacesublimexampleenterfoundtonightcryptotonightsublimnoticesuccesssublimtheentertonighttheshouldthefoundsystemtonightuserbackspacesuccessshouldwebackspacenoticebackspacebackspacenoticewecryptobackspacebackspaceusertonightlearnsuccessmorningusertonightsuccessshouldbackspacecryptoenterentershouldsublimsystemexamplemorningcryptonoticethesuccessthebackspacenoticelearnsublimlearnsuccesscryptothesuccessenternoticecryptosystemsublimsuccesswebackspaceuserenterlearnuserwewemorningsuccesslearncryptobackspacewecryptosystemlearnenterenteruserexamplefoundsystemcryptousernoticefoundusersublimbackspacewesublimnoticemorningshouldexamplenoticecryptoshouldtonightmorningthefoundsystementerentersystemthecryptobackspacesublimlearnsuccessmorningsublimsystemcryptousersublimwesuccessmorningsublimbackspacecryptobackspacesublimthelearnsuccesssublimlearncryptoweweexamplecryptowenoticelearnfoundbackspacesystemsystemexampleshouldlearnsuccesssublimcryptobackspacetonightbackspacemorningmorningnoticeshouldnoticefoundthetheshouldtheshouldfoundfoundcryptosuccessbackspacesuccessshouldweenternoticeweweshouldmorningfoundusersuccessbackspacewenoticeusersuccessenterenterexamplelearnfoundwetonightusercryptothesublimsublimtonightsuccesslearnbackspacetonightentertonightthesublimnoticewefoundcryptobackspaceenterenterlearnlearntonightexamplesystementersublimnoticecryptoshoulduseruserbackspaceuserwesublimmorningwesystemshouldtonighttheusershouldnoticefoundusernoticeentersublimwethewefoundfoundlearnfoundwecryptosystemexamplemorningcryptocryptosublimtheexamplenoticefoundlearnwelearnmorningtheenterthesystemsublimtonightsuccesssystemlearnshouldenterbackspaceentersuccesssuccessbackspaceexamplenoticeentershouldsublimlearnbackspacetheshouldexamplelearnsystemusersublimbackspacebackspacesuccesswelearntonightexamplewecryptoenterwesystemsystemsublimexamplecryptolearnmorningsublimfoundsublimfoundbackspacefoundtonighttonightnoticesuccesssuccessexampleusersuccesstonightsublimcryptosystemweenterexamplesystemthethenoticesublimtonightbackspacenoticesystemexamplethesuccesstonightmorningsuccesstonightwenoticesublimtonightwelearntonightmorningsublimbackspaceenterthetonightenterwecryptofoundtheenternoticebackspacesuccesswesystemuserexamplebackspaceentersuccesstonightsublimwemorningsuccesssuccesswesublimsuccessnoticesublimfoundlearnlearnweexamplecryptonoticelearnweusershoulduserfoundcryptolearnfoundmorningtonightmorningmorningnoticewecryptowewesuccessfoundsublimweuserentershouldshouldshouldsublimbackspacetonightenterwesublimsuccessshouldfoundthethetonightwecryptoweenterfoundcryptoshouldcryptouseruserfoundentersublimsublimthelearntheshouldnoticebackspacefoundsuccessshouldtonightentermorningsystemmorningtonightwenoticelearnbackspaceexampleusershouldnoticesublimsublimexamplethesuccessnoticesystemmorningnoticecryptosystemsublimcryptosystemsuccessshouldmorningbackspaceshouldmorninglearnnoticenoticeshouldthewewesublimsublimnoticeusersuccessentersystemfoundshouldshouldcryptobackspaceusermorningsystemshouldshouldtonightwesublimuserfoundlearnbackspacethetonightmorningexampleuserthefoundbackspaceshouldtonightcryptocryptofounduserexamplenoticecryptousernoticethenoticeshouldweshouldfoundwemorningcryptosuccesslearnfoundtonightsublimnoticenoticewefoundwewesuccesssublimsublimcryptoweexampletonightsuccessfoundshouldsuccesstonightbackspacesystemshouldwesystemnoticebackspaceusersystembackspacewenoticelearnnoticenoticesuccesslearntonightuserlearnsuccessbackspacesuccesswesystemusercryptonoticethesystemusernoticewethesuccessweshouldfoundshouldcryptomorningtonightwethewesuccesslearntheshouldweexampletonightsuccessnoticenoticemorningfoundmorningfoundusersublimsystemsuccessbackspacesuccessmorninguserthefoundweexamplemorningsublimlearnfoundfoundnoticemorningshouldweuserwemorningexamplesuccesssuccessfoundthetheshouldweusershouldtheshouldexamplenoticefoundsuccesssystemfoundshouldsublimbackspacetonightshouldsystemtonightsuccesslearntonightsystemsublimsuccesscryptobackspacesystemsublimmorningmorningshouldmorninglearnsuccesslearnmorningusermorninglearnexamplecryptoshouldbackspacesublimshouldfoundbackspacesystemsystemweexamplesystemtonightsublimmorningmorninguserfoundcryptolearnbackspaceshouldbackspacenoticesublimfoundthecryptousershouldsuccesssystemsuccessshouldsystembackspacesublimshouldsublimsystembackspaceexampleshouldbackspacesublimnoticelearnsublimuserbackspaceusersublimsuccesssublimuserusernoticeshouldsuccessnoticenoticelearnexamplesystemweexamplesublimbackspacebackspacecryptoshouldusercryptosublimbackspacesublimshouldsystemnoticenoticethesuccesssuccesslearnsystemsublimwenoticelearnusersublimsystemusernoticeuserthesuccesslearnwelearnwenoticecryptolearncryptonoticenoticebackspacecryptothecryptousercryptobackspacesuccesslearnthesystemsuccessthesystemsystemcryptosuccessbackspacesublimlearnsublimcryptobackspacelearnsublimusersublimexamplecryptosublimsystemnoticecryptocryptousertheusernoticebackspacenoticenoticethecryptocryptosystembackspacesublimbackspacecryptocryptobackspacesystemuserthenoticesystemsystemsystemusernoticethecryptouserusersystemtheusercryptoexamplenoticecryptoexamplenoticetheexampleexamplethecryptotheusernoticetheexampleexamplecryptotheexampleexamplethenoticethecryptocryptoexampletheexamplecryptocryptothenoticeexamplecryptonoticetheexampleexampleexamplecryptocryptoexampleexamplethenoticethecryptothethethethethetheexampleexamplethetheexampletheexampletheexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexample
```

å¥½å¤šè¿åœ¨ä¸€èµ·çš„è¯æ±‡ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªç®€å•NTPé¢˜ç›®ï¼Œä¹Ÿå°±æ˜¯NLPæœ€åŸºç¡€çš„ä¸€ä¸ªæ­¥éª¤ï¼Œåˆ†è¯ã€‚

è¿™é“é¢˜ç›®çš„å¤§è‡´æ€è·¯åº”è¯¥æ˜¯ï¼š

1. åˆ†è¯
2. è¯é¢‘ç»Ÿè®¡
3. ç»Ÿè®¡æ’åº
4. æ ¹æ®æ’åºä½ç½®æ‰¾åˆ°æŒ‡å®šçš„å•è¯
5. æ‹¼æ¥å•è¯

æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œå†™ä¸ªè„šæœ¬å¤„ç†ä¸€ä¸‹å“ˆï¼š

```python
from collections import Counter // ç»Ÿè®¡åº“
import wordninja // è‹±è¯­å•è¯è¯åº“
data="tonightsuccessnoticenoticewewesuccesstonightweexamplecryptoshouldwebackspacetonightbackspaceexamplelearnwesublimlearnbackspacetheshouldwelearnfoundsublimsystemexamplesublimfoundlearnshouldmorningsublimsystemuserlearnthecryptomorningexamplenoticetonightlearntonightlearntonightsublimenterusermorningfoundtonightweenterfoundnoticethecryptomorningthebackspacelearntonightlearnsublimtonightlearnfoundenterfoundsuccesstonightsuccessuserfoundmorningtonighttheshouldsublimentertonightenterbackspacelearnexamplenoticeexamplefoundsystemsuccesssublimsuccessshouldtonightcryptowelearncryptofoundshouldsublimsublimweentertonightsuccessshouldentertheentercryptouserbackspaceshouldentersystemsuccesssystementerfoundenterlearnexampletonightnoticemorningusertonightlearnmorningtonightfoundfoundsuccessnoticesystementerlearnexamplebackspaceshouldcryptocryptosublimweexampletonighttheshouldthemorningbackspacelearntonightsystemsuccesssuccessbackspacemorningnoticeuserfoundfoundtonightmorningenterenterthefoundbackspacelearnenterentershouldthesystemfounduserlearnlearnsystemnoticetonighttheshouldlearnuserbackspaceweusernoticeshouldthewefoundsystemwecryptocryptowethebackspacesystementershouldtonightsystemnoticemorningsystemweentermorningfoundsuccessusertonightsuccesstonightbackspaceshouldweenterthewesystemusernoticesystemthelearnexamplelearnfoundlearnnoticeexamplesystemthecryptocryptolearnsystemthecryptoenterlearnexamplemorningmorningweenterentersuccessexampleuserthebackspacenoticesublimenterbackspacesuccessbackspacethesublimexamplesystemtheexamplecryptolearnuserexamplelearnsystemusersuccessenterentersuccesstheuserbackspacelearnsuccessbackspacethesublimshouldwebackspaceexamplesuccesssuccesstonightweusershouldsuccessmorningcryptomorningfoundbackspacesublimshouldentershouldnoticesuccessmorningsuccessexamplelearnshouldsublimlearntonightshoulduserbackspacesublimlearncryptosuccessenternoticetonightmorningtonightwesuccessweuserbackspaceexamplewesystemnoticemorningsystemmorningcryptolearnsystemthethefoundcryptouserlearnusersystemwemorningenterexampleshouldlearncryptofoundenterbackspacelearnenterenterbackspaceshouldbackspacetheshouldthesystemshouldshouldsuccessmorningthefoundsystementersystemtonightcryptowelearnexampleexamplesystementerbackspaceshouldtheentersublimtonightfoundfoundsuccesssuccesssystemsublimcryptoshouldentersublimmorninglearnfoundtonightcryptobackspacesuccesscryptowebackspacefoundshouldnoticeshouldmorningnoticesystemcryptosystemlearnsystemnoticemorningsystementerwemorninglearnsuccessfoundwesuccesswetheusercryptousernoticebackspacesuccessshouldtonightmorningentermorninguserenternoticefoundmorningwetonightsystemthecryptotonightcryptosystemuserthefoundexampletonightusersystemcryptosublimmorninguserthefoundbackspaceshouldsuccesscryptotonightsystemnoticebackspaceusershouldenterthecryptomorningwesublimnoticesuccessnoticeusersuccesstonightlearnweuserenterfounduserexampleshouldshouldtonightwelearnthenoticethewefoundmorningexampleshouldexamplethesuccessnoticeenterfoundthecryptonoticeuserlearnuserweenterfoundmorningsystemweexamplenoticethebackspaceexamplesublimtheusermorningtonightthesuccesscryptosuccessusersuccesstonighttonightwelearnenterenterthemorningentersystemcryptobackspacemorningsystemexamplecryptouserexamplelearnsublimsuccessusersystemfoundmorningshouldcryptotonightsublimtheexamplemorningsystemuserexampleweexamplenoticesuccesssublimnoticecryptoshouldbackspaceshouldthetonightfoundsublimbackspacebackspacetonightshouldbackspacesuccesstonightbackspacesuccessmorningsystemcryptobackspaceentertonighttonightnoticelearnshoulduserfoundexamplesystemthesuccessweusertonightcryptousernoticeenternoticebackspaceusersystemfoundusernoticeshouldlearnuserfoundexampleusermorningshouldsuccessmorningmorningexampleexamplefoundsublimfoundenterbackspacenoticelearnfoundmorningcryptonoticecryptoshouldweshouldtonightcryptobackspacesublimcryptosublimenterentersublimentercryptonoticethethesublimexampleenterentershouldlearncryptoentershouldmorninglearnnoticeuserexamplesublimtonightshouldfoundtonightsuccessshouldmorningfoundtheweuserlearnsublimsystembackspacecryptotheusertonightcryptosublimmorningmorningexamplenoticetheenterlearnshouldmorningsublimfoundtonightsublimsublimexamplefounduserexamplethefoundwemorningnoticefoundcryptosuccesssublimsublimexamplethesuccessexamplenoticesuccessbackspacesublimlearnuserexamplesuccesssuccesssystemsuccessmorningmorninglearnexamplemorningtonightfoundbackspaceenternoticemorningentersuccessmorningusermorningbackspacelearncryptoenteruserenteruserthetonighttonightsuccesslearnenterfoundsuccesssystemfoundbackspaceenterlearnsystemsublimcryptoentermorningwetonightshouldlearnenterfoundcryptonoticelearnlearnshouldfoundsuccessexampletonightthesuccessfoundusertonightenterfoundsuccessshouldmorningusernoticemorningsystemsystemsuccessshouldwelearnenterfoundexamplewethefoundweshouldsystemsystemmorningmorningbackspaceshouldentersublimentertonightsuccesssystemsystemcryptousershouldsublimfoundwetonightnoticeexamplewewesuccessfoundusertonightfoundsystemexamplecryptofoundshouldshouldsuccessenterbackspaceexampletonightthelearnnoticeuserlearnsystemsublimfoundlearnsuccesssystemshouldsublimnoticelearnsystemnoticetonightexamplefoundusernoticeenterlearnnoticecryptousersystemmorningthewesystemfoundfoundshouldsystementerenterbackspacesystemsublimcryptousermorninglearnlearntonightsublimlearnenterenterbackspacesystemuserusercryptoentershouldtheusersublimnoticeexamplemorningexamplesublimsublimbackspacesystemexampleshouldsublimlearnfoundenterbackspacelearnmorningmorningfoundthetonightmorningnoticeenterlearnusersystemtonightbackspaceexamplelearntonightbackspaceweshouldcryptosuccessbackspaceexamplesuccesstheshouldmorninguserbackspacelearnthetheshouldcryptocryptotonightbackspacecryptocryptobackspacebackspacenoticeusertonightentermorningfoundweenterexampleenterfoundusersublimsystemtheexampleexamplesystemsuccessusersublimentermorningbackspacesystemfoundlearnsystemshouldsublimsublimentershouldtheusershouldexampleexampleshouldsuccesswelearnfoundsublimshoulduserweentertonightwenoticesublimsystemlearnshouldfoundsuccessuserentersuccessmorningcryptoenteruserfoundexampletonightlearnexampleexamplefoundlearnsuccesssystembackspacecryptonoticethefoundbackspacelearncryptothelearnlearnexamplesuccessnoticenoticesystemmorningcryptotonightnoticenoticeentersuccesscryptoenterbackspacesublimexampleenterfoundtonightcryptotonightsublimnoticesuccesssublimtheentertonighttheshouldthefoundsystemtonightuserbackspacesuccessshouldwebackspacenoticebackspacebackspacenoticewecryptobackspacebackspaceusertonightlearnsuccessmorningusertonightsuccessshouldbackspacecryptoenterentershouldsublimsystemexamplemorningcryptonoticethesuccessthebackspacenoticelearnsublimlearnsuccesscryptothesuccessenternoticecryptosystemsublimsuccesswebackspaceuserenterlearnuserwewemorningsuccesslearncryptobackspacewecryptosystemlearnenterenteruserexamplefoundsystemcryptousernoticefoundusersublimbackspacewesublimnoticemorningshouldexamplenoticecryptoshouldtonightmorningthefoundsystementerentersystemthecryptobackspacesublimlearnsuccessmorningsublimsystemcryptousersublimwesuccessmorningsublimbackspacecryptobackspacesublimthelearnsuccesssublimlearncryptoweweexamplecryptowenoticelearnfoundbackspacesystemsystemexampleshouldlearnsuccesssublimcryptobackspacetonightbackspacemorningmorningnoticeshouldnoticefoundthetheshouldtheshouldfoundfoundcryptosuccessbackspacesuccessshouldweenternoticeweweshouldmorningfoundusersuccessbackspacewenoticeusersuccessenterenterexamplelearnfoundwetonightusercryptothesublimsublimtonightsuccesslearnbackspacetonightentertonightthesublimnoticewefoundcryptobackspaceenterenterlearnlearntonightexamplesystementersublimnoticecryptoshoulduseruserbackspaceuserwesublimmorningwesystemshouldtonighttheusershouldnoticefoundusernoticeentersublimwethewefoundfoundlearnfoundwecryptosystemexamplemorningcryptocryptosublimtheexamplenoticefoundlearnwelearnmorningtheenterthesystemsublimtonightsuccesssystemlearnshouldenterbackspaceentersuccesssuccessbackspaceexamplenoticeentershouldsublimlearnbackspacetheshouldexamplelearnsystemusersublimbackspacebackspacesuccesswelearntonightexamplewecryptoenterwesystemsystemsublimexamplecryptolearnmorningsublimfoundsublimfoundbackspacefoundtonighttonightnoticesuccesssuccessexampleusersuccesstonightsublimcryptosystemweenterexamplesystemthethenoticesublimtonightbackspacenoticesystemexamplethesuccesstonightmorningsuccesstonightwenoticesublimtonightwelearntonightmorningsublimbackspaceenterthetonightenterwecryptofoundtheenternoticebackspacesuccesswesystemuserexamplebackspaceentersuccesstonightsublimwemorningsuccesssuccesswesublimsuccessnoticesublimfoundlearnlearnweexamplecryptonoticelearnweusershoulduserfoundcryptolearnfoundmorningtonightmorningmorningnoticewecryptowewesuccessfoundsublimweuserentershouldshouldshouldsublimbackspacetonightenterwesublimsuccessshouldfoundthethetonightwecryptoweenterfoundcryptoshouldcryptouseruserfoundentersublimsublimthelearntheshouldnoticebackspacefoundsuccessshouldtonightentermorningsystemmorningtonightwenoticelearnbackspaceexampleusershouldnoticesublimsublimexamplethesuccessnoticesystemmorningnoticecryptosystemsublimcryptosystemsuccessshouldmorningbackspaceshouldmorninglearnnoticenoticeshouldthewewesublimsublimnoticeusersuccessentersystemfoundshouldshouldcryptobackspaceusermorningsystemshouldshouldtonightwesublimuserfoundlearnbackspacethetonightmorningexampleuserthefoundbackspaceshouldtonightcryptocryptofounduserexamplenoticecryptousernoticethenoticeshouldweshouldfoundwemorningcryptosuccesslearnfoundtonightsublimnoticenoticewefoundwewesuccesssublimsublimcryptoweexampletonightsuccessfoundshouldsuccesstonightbackspacesystemshouldwesystemnoticebackspaceusersystembackspacewenoticelearnnoticenoticesuccesslearntonightuserlearnsuccessbackspacesuccesswesystemusercryptonoticethesystemusernoticewethesuccessweshouldfoundshouldcryptomorningtonightwethewesuccesslearntheshouldweexampletonightsuccessnoticenoticemorningfoundmorningfoundusersublimsystemsuccessbackspacesuccessmorninguserthefoundweexamplemorningsublimlearnfoundfoundnoticemorningshouldweuserwemorningexamplesuccesssuccessfoundthetheshouldweusershouldtheshouldexamplenoticefoundsuccesssystemfoundshouldsublimbackspacetonightshouldsystemtonightsuccesslearntonightsystemsublimsuccesscryptobackspacesystemsublimmorningmorningshouldmorninglearnsuccesslearnmorningusermorninglearnexamplecryptoshouldbackspacesublimshouldfoundbackspacesystemsystemweexamplesystemtonightsublimmorningmorninguserfoundcryptolearnbackspaceshouldbackspacenoticesublimfoundthecryptousershouldsuccesssystemsuccessshouldsystembackspacesublimshouldsublimsystembackspaceexampleshouldbackspacesublimnoticelearnsublimuserbackspaceusersublimsuccesssublimuserusernoticeshouldsuccessnoticenoticelearnexamplesystemweexamplesublimbackspacebackspacecryptoshouldusercryptosublimbackspacesublimshouldsystemnoticenoticethesuccesssuccesslearnsystemsublimwenoticelearnusersublimsystemusernoticeuserthesuccesslearnwelearnwenoticecryptolearncryptonoticenoticebackspacecryptothecryptousercryptobackspacesuccesslearnthesystemsuccessthesystemsystemcryptosuccessbackspacesublimlearnsublimcryptobackspacelearnsublimusersublimexamplecryptosublimsystemnoticecryptocryptousertheusernoticebackspacenoticenoticethecryptocryptosystembackspacesublimbackspacecryptocryptobackspacesystemuserthenoticesystemsystemsystemusernoticethecryptouserusersystemtheusercryptoexamplenoticecryptoexamplenoticetheexampleexamplethecryptotheusernoticetheexampleexamplecryptotheexampleexamplethenoticethecryptocryptoexampletheexamplecryptocryptothenoticeexamplecryptonoticetheexampleexampleexamplecryptocryptoexampleexamplethenoticethecryptothethethethethetheexampleexamplethetheexampletheexampletheexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexample"
lm = wordninja.LanguageModel('my_dict.txt.gz') // é€šè¿‡è°ƒè¯•å†™å‡ºçš„ç®€å•å­—å…¸
data_list = lm.split(data)
data_count = Counter(data_list)
index = 1
hint_list = [4,8,11,15,16]
m = ""
for i in data_count.most_common(20)[::-1]:
    if index in hint_list:
        m += i[0]
    index += 1
print(m)
```

è¿è¡Œä¸€ä¸‹è„šæœ¬ï¼š

```txt
weshouldlearnthecrypto
```

æ¸¸æˆç»“æŸï¼å¾—åˆ°flagï¼š

```txt
flag{weshouldlearnthecrypto}
```



## 0x1 [AFCTF2018]Vigenere

ç»´å‰å°¼äºšå¯†ç ï¼Œå¤šè¡¨æ›¿æ¢å¯†ç ã€‚æ¥ç§ç§é¢˜ç›®çš„é™„ä»¶ï¼š

ä¸¤ä¸ªé™„ä»¶æ–‡ä»¶ï¼Œä¸€ä¸ªåŠ å¯†çš„`flag_encode.txt`å’ŒåŠ å¯†ç®—æ³•çš„`Encode.c`

Encode.c

```c
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main()
{
	freopen("flag.txt","r",stdin);
	freopen("flag_encode.txt","w",stdout);
	char key[] = /*SADLY SAYING! Key is eaten by Monster!*/;
	int len = strlen(key);
	char ch;
	int index = 0;
	while((ch = getchar()) != EOF){
		if(ch>='a'&&ch<='z'){
			putchar((ch-'a'+key[index%len]-'a')%26+'a');
			++index;
		}else if(ch>='A'&&ch<='Z'){
			putchar((ch-'A'+key[index%len]-'a')%26+'A');
			++index;
		}else{
			putchar(ch);
		}
	}
	return 0;
}
```

flag_encode.txt

```txt
Yzyj ia zqm Cbatky kf uavin rbgfno ig hnkozku fyyefyjzy sut gha pruyte gu famooybn bhr vqdcpipgu jaaju obecu njde pupfyytrj cpez cklb wnbzqmr ntf li wsfavm azupy nde cufmrf uh lba enxcp, tuk uwjwrnzn inq ksmuh sggcqoa zq obecu zqm Lncu gz Jagaam aaj qx Hwthxn'a Gbj gfnetyk cpez, g fwwang xnapriv li phr uyqnvupk ib mnttqnq xgioerry cpag zjws ohbaul drinsla tuk liufku obecu ovxey zjwg po gnn aecgtsneoa.

Cn poyj vzyoe gxdbhf zq ty oeyl-ndiqkpl, ndag gut mrt cjy yrrgcmd rwwsf, phnz cpel gtw yjdbcnl bl zjwcn Cekjboe cklb yeezjqn htcdcannhum Rvmjlm, phnz juoam vzyoe nxn Tisk, Navarge jvd gng honshoc wf Ugrhcjefy. â€” Cpag zq kyyuek cpefk taadtf, Mxdeetowhps nxn qnfzklopeq gvwnt Sgf, xarvbrvg gngal fufz ywwrxu xlkm gnn koaygfn kf gnn ooiktfyz, â€” Tugc ehrtgnyn aae Owrz uh Yireetvmng hguiief jnateaelcre bl cpefk gfxo, ig ob bhr Xkybp os zqm Prurdy po nrcmr bx vg uxoyobp ig, gpv nk iaycqthzg fys Gbbnznzkpl, fwyvtp qtf lqmhzagoxv oa ywub lrvtlqpyku shz oemjvimopy cps cufmrf op koyh suau, af zq lbam fnjtl fkge gksg rrseye vg ybfric bhrot Kubege jvd Ugrhcjefy. Yzuqkpuy, enqknl, wvrn vcytnzn bhnz Igparasnvtf rqfa asggktifngv mdohrm vog hg ubwntkm noe rkybp aaj czaaykwhp cnabms; ntf swyoejrvgye cdf axckaqeaig zuph fnnen gncl gwnxowl aek ogla dvyywsrj vg mqfska, ehvrg wpelf gam shlhwlwbyk cpaa zq jcchg zqmmfknnyo bl gkwlvyjahc tuk owrzy vg qdipn cpel gtw uychycwmrj. Dmn shrt j toam vjuen bl jjufku shz ufaaxagoqfm, lueydqnt opnuninhug tuk usga Oopnkt rbkfwas n jnaitt vg ladhin bhrs wfxar nhbwlhzg Vyopbzram, vz kk ndevx aqguz, kl co tukrz dhza, li pheuf wfs ywub Coikavmrtv, shz tb vawvvjg fys Ghgals sut lbaie ldbuek uwwqrvzh. â€” Aupn jsm xert cpe cgvayjt faoneegpuy kf gnnae Pungheef; gwl shij am joj zqm nrigkmetl cqqcu iqfmprnowa tuko li wlgka bhrot xinmrx Bgsgkok ib Gbbnznzkpl. Nde uobboee qx nde cxnaeaz Mahc os Mamag Htanwia ob i hvyvglu os xnxenzgv cjjhxrms ntf mmqrcgcqoay, cdf daiowo ia jkjyyt bhsmcg zjw yotnhuqsusgfn kf nt jjsbrwly Pyegwvy bbgj ndefk Bbagku. Li lrbbn bhvy, nwn Bapzb je fadecptrj cw a pgpvcz wbxul.

Hr nck lafhynl hvy Ckmang zx Tajy, vzy iofz fpoykugga aaj wmcryuslu fbx cpe caddcy gbum.

Pe ugu xinbvjmmn uou Yireetxzs gu rsmo Lncb wf vsowxeagk jvd cxgkment ovxoezcfwa, uarnas fauhyjdrj rv tukkj ileegcqoa zkdf dif Gbaeaz uziqlq hn wbggkfyz; aaj fpea yq kooprtmmd, uk jsm qtgkaty akidyytrj cw agzgfx po gnnu.

Hr nck lafhynl tb vckm ktuka Tajy hgl phr glkozsqvupibt xn lnxiw xesgxrktf uh hykpyk, dvlryu lbksr vnwpyk ygohd ekuqndakkb phr xrohg uh Jylrrynvtnzkgh en gnn Tetoudupuek, j zitnv ahasgovibyk vg ndez gwl fbxoaxwbyk cw tlxcfno oarh.

Pe ugu uuhlrj cwgrzjwl hetobtagoxw vkdvkb it crcuyo uaabcay, apuiifbxcibyk, cfx zifzjvt sxqe nde qkywsvzqjs kf gnnqr Caddcy Rrixzdf, lqj nde fuum phxrgma os ljbitakfa phrs rvtb iqejhintlm wvzj zco mrgbcrry.

Jw bws qobaoybgv Lapekbmnggvapa Hbabms ekrwupeqrh, noe urhioiam fqtu scffu fvxvvefy jam enigbqoay qf nde eopptf uh lba pruyte.

Uk jsm nesabmd sut s fknt zrue, nlvwl oupn mqsfunmneoay, cw cnauw iphrxb bo ok gdyytrj, fpeekdq nde Ykpqsygvapa Pbcnzs, vtesjwbyk xn Aatkzchagoxv, hnbg jypuetnl tb zjw Jaocrn it ygtyy boe zqmie kzwlyifk; cpe Fzcly nezgrviam kf nde zkjv tvsg wrlofkm bo nrn lba dntpmrf uh ahrafoxv feuo ocphbac, inq iqfpqlfoxvs jovzcj.

Hr nja eajgspkuekm bo cxgnyjt gnn xocansneoa uo bhryg Knwtry; owr gncl jqrcubm ooyvjoytvtp bhr Rcom boe Tjbuegnatwtvuw wf Sutwccnrxb; zesauahc tb vjas bzjwlo tb kwkohxcyy phroa uitxclcknf nrbhrx, cfx navyrvg gng uijdvzrwnf uh fys Acvawpeoclcknf uo Taaju.

Zy daf ukateaelyz tuk Jlmvtkknnagoxv os Pwknecr hh zesauahc hvy Jasrtv li Hajy owr ryvsvhifnrvg Wafaweaee Ywwrxu.

Zy daf sjle Wafyyo drvnvdrtv gh dif Crtl nrqfy boe zqm trtwjy kf gnnqr blhawas, ntm bhr gogojt ntm xalsgfn kf gnnqr fgnsleef.

luig vy cxwpf{Jnxwobuqg_O_Cogiqi!}

Hr nck ynepznl a zanlcpuqk xn Nrc Qxzecry, jvd fkpl betuka awnxok ib Oslrkeey vg bwrnyb wue vggjhe ntm mag uwl ndevx bcbfzcfwa.

Hr nja krvv sgknt ab, qn goowm kf ckjke, Fzcfxent Gauiry yandohz cpe Pupkyjt bl xcr ykiamhagaams.

Uk jsm wfsklbeq zq jyjdrx cpe Zonanwrl owleckpvyjt bl jvd farwleoe zx bhr Iknch Pbcnz.

Hr nck wkmoowmd jovz iphrxb bo fadbyyt hy cw a watamzipzrwn sutwccn gu xcr pupknethzrwn, ntf mhwcxtxelrjiwx xy baa tajy; iapent nra Afygfn po gnnqr Nivk ib pekcmnqkf Dycifrjbibt:

Hgl munxcmrvti dungr hxliry qx unmrj czobvu sgknt ab:

Noe vtgnacgowo tuko, ts w mbit Brvgn xlkm cawqsusgfn boe gwg Mhxfwlo wuolp tuka kbkuyj lwmzov gh phr Owpaoovshps bl cpefk Ulupef:

Lxz chzvahc osl xcr Gxcvy sign jtl cgtlm kf gnn eoerf:

Xin izvxaiam Vsras bt da wvzjgop ohx Lwnfkpl:

Zkr qkyziiopy oo ia sjvy pguwm, kf gnn jeakhan kf Gxril oe Lmlu:

Fbx czaayrglpiam da breqfx Oeny cw br ztayz fbx yzegkpvyz oslnvcry:

Hgl wbbrrahvti lba fekn Ayfzge ib Eamuqsu Rcom en n tnqguhqmlent Vawvvtew, yotnhuqsuopy ndeekrv aa Gttcprnxh ooiktfgang, gwl earcjaent oca Bbapvuniry bw af zq jyjdrx rb ag upuy wn rdjupyk cfx big owateaowhp fbx rvteufmwent zqm snsg svooyacm rhrg ahpo gnnae Pungheef

Lxz tnqkfa wwne xcr Pncjnarf, gkwlvyjahc ohx vwsg bcdowbyk Uiwf gpv uhtrxrvg sapvuieazjtll zjw Zkrzy xn ohx Igparasnvtf:

Lqj mqsckwliam qml kwa Rnoifrclonef, gwl drinslent zqmmfknnyo iabnatrj yand pbcnz tb rgycolnzn noe au ah wly ijaef cjsnoorbnz.

Hr nck uxdvijbeq Mqnynnzkwb hrxg, ts zeprjziam wk iqt bl qqs Cxqlyytvuw inq ccycjg Jga ignopkn qs.

Uk qis crwfxarrj xcr fkck, lwvnmnl ohx eguotf, hdzng uwj nkway, jvd qkullkyrj cpe yoxwm kf baa xebvnw.

Ba if gc bhvy vaga tegwapbxvahc lnxpm Aeskwm kf suamitt Owlyeagaqef zq uiipykjb tuk yglgs bl mmagn, fwmklnzrwn, ntf lsnaath, ilekcvs xetaw eign ealyuzycinpku gz Yrhkuby & Cktxczy fijzcrra hunayrnteq op lba mbyc jaehcjiqs nmna, aaj vgnwlye dvwbxvzs phr Nnid bl c ucriyoimd agvaij.

Hr nja cbtullwiakm wue lgdfkw Pocqzrtu lugea Ijxtvbg gh phr nroh Fkck nk brga Irzy cyuenfz cpevx Egojtee, cw briqey phr kgmchzkgharf uo bhrot xleeajb inq Htwndrrt, xz tb lcdf phrsbmliku ts phroa Paaju.

Zy daf kgkigkf viiefzrk iaywjlacgoxvs nsqfaot hy, jvd ugu whzenbxcrrj vg vniam xv tuk kfbwbvzjvtf uh gon feuwbirxu, lba mrxlqlryu Ahzint Bivnmgk qdofk tvojt tmfa os cjzfnxg, am wn htmqsgopyoesukm lefztmwpibt xn ayr cyyo, srdna aaj eghzigoxvs.

Vt gnyny fzjoe bl vzyoe Bvyzefykgho Wr njde Ckvaneoakm noe Xgvlasf ow bhr sqkn duzhum trxok: Iqr ekymagkf Hypigoxvs ugxw vaea gwawrxgv ijll hh zeckclyz iapdzy. N Vtahye, jnxae pncjuytrx ra tuau eunkrj kg eiktq uyt jnrkh zga vybiak j Byegpl, co ualrb tb hg lba rhrnz os g hjya pruyte.

Aut zure Jk kmea ccfnent ow itgkplcknf zx wue Htanesu hamtuxgf. Qa hnbn eaetgv ndez lawm goow nk tvsn wf nzvwgltf hh bhrot dycifrjbuek vg yttrtm in htyslnaazjjlr pwjcodvicqoa uxwl qs. Jk qivr xgecjdrj cpez uh lba cvxlcmfzcfwas bl xcr rskylwtvuw inq yglnhezkwb hrxg. Oy daik jxprgnwx po gnnqr agvapa jhycqcr gpv gwgagwqmvza, shz wr njde pupboneq zqmm oe vzy piry xn ohx eggioa qrvdekf li zifgeww gngky qshxyitvupk, qdipn fwuyj kfyriggkty vtvwlnucz xcr pupfyytvuwa aaj eglnefvxvdrtew. Ndel zxw hnbg tyan qkjn tb zjw pkipk xn jhyvawa aaj xn cbtushcuvtrby. Jk ommp, tukamfbxg, swmuvkbke vt vzy jepkbaige, yzcyh qkwwuaigk iqr Fkyirnzkgh, wnq nxtd gnge, uo wr nxtd gng jyot bl vinxopv, Yjezona ia Ccj, cj Prglm Feogfxo.

Wr, zqmrrlqjy, phr Xnxrrygfnwtvbna os zjw ojigkm Atnzgk ib Azkaqcn, op Yyjeegu Koamtwmo, Afynubykf, sjlenrrvg gu vzy Oucxnue Wafyy kf gnn eoerf xin tuk amcgovmxa os udz iazgfneoay, mw, ia zjw Hwmr, gwl bl Gwlbkrvzh wf gng yikd Ckxxlr uh lbasr Ixtoaogk, mklrswty caddcoh ntm leprcjy, Phnz cpefk wfcpeq Ixtoaogk une, ntm wf Eoizn kutnc bo ok Hjya aaj Rvdrvgfxang Ycitry, vzup tukh irr Gdkihvrj ozoz gnd Uhlrmrinpk vg nde Oxrbifn Ejisn, ntm bhnz cdf loyocqcnr eghjepzrwn okvoyan gnnu aaj vzy Otnzn wf Txgsn Xrvzjqn, vy cfx kutnc bo ok vgnwlye mqsfunnyz; aaj cpag gu Xlae ntm Qnqkrwhzeaz Bbagku, lbay ugem fhrn Hisee zx teie Ysl, yoaiucdr Vgswa, cbtczapz Cdfeaaina, efzctfesu Ixumrxew, ujd gu mw ayr qlbar Nica aaj Vzcjgf cqqcu Opvyleajnvt Fzclyo mne xn rvmjl xk. â€” Aaj owr gng kolpbxc wf gnkk Xacygaitvup, ocph n lrzm eknaujcr uw bhr vtgnacgoxv os Jkncje Cxxdiqkpuy, se zaccayra hfadtk cw enij gndee udz Lvbgk, iqr Suabuaku, shz ohx bicekf Zijoe.
```

ç›´æ¥å»ç»´å‰å°¼äºšå¯†ç ç ´è§£ç½‘ç«™è¿›è¡Œç ´è§£å°±å¥½ï¼Œè¿›è¡Œç ´è§£å¾—åˆ°ï¼š

```txt
When in the Course of human events it becomes necessary for one people to dissolve the political bands which have connected them with another and to assume among the powers of the earth, the separate and equal station to which the Laws of Nature and of Nature's God entitle them, a decent respect to the opinions of mankind requires that they should declare the causes which impel them to the separation.

We hold these truths to be self-evident, that all men are created equal, that they are endowed by their Creator with certain unalienable Rights, that among these are Life, Liberty and the pursuit of Happiness. â€” That to secure these rights, Governments are instituted among Men, deriving their just powers from the consent of the governed, â€” That whenever any Form of Government becomes destructive of these ends, it is the Right of the People to alter or to abolish it, and to institute new Government, laying its foundation on such principles and organizing its powers in such form, as to them shall seem most likely to effect their Safety and Happiness. Prudence, indeed, will dictate that Governments long established should not be changed for light and transient causes; and accordingly all experience hath shewn that mankind are more disposed to suffer, while evils are sufferable than to right themselves by abolishing the forms to which they are accustomed. But when a long train of abuses and usurpations, pursuing invariably the same Object evinces a design to reduce them under absolute Despotism, it is their right, it is their duty, to throw off such Government, and to provide new Guards for their future security. â€” Such has been the patient sufferance of these Colonies; and such is now the necessity which constrains them to alter their former Systems of Government. The history of the present King of Great Britain is a history of repeated injuries and usurpations, all having in direct object the establishment of an absolute Tyranny over these States. To prove this, let Facts be submitted to a candid world.

He has refused his Assent to Laws, the most wholesome and necessary for the public good.

He has forbidden his Governors to pass Laws of immediate and pressing importance, unless suspended in their operation till his Assent should be obtained; and when so suspended, he has utterly neglected to attend to them.

He has refused to pass other Laws for the accommodation of large districts of people, unless those people would relinquish the right of Representation in the Legislature, a right inestimable to them and formidable to tyrants only.

He has called together legislative bodies at places unusual, uncomfortable, and distant from the depository of their Public Records, for the sole purpose of fatiguing them into compliance with his measures.

He has dissolved Representative Houses repeatedly, for opposing with manly firmness his invasions on the rights of the people.

He has refused for a long time, after such dissolutions, to cause others to be elected, whereby the Legislative Powers, incapable of Annihilation, have returned to the People at large for their exercise; the State remaining in the mean time exposed to all the dangers of invasion from without, and convulsions within.

He has endeavoured to prevent the population of these States; for that purpose obstructing the Laws for Naturalization of Foreigners; refusing to pass others to encourage their migrations hither, and raising the conditions of new Appropriations of Lands.

He has obstructed the Administration of Justice by refusing his Assent to Laws for establishing Judiciary Powers.

He has made Judges dependent on his Will alone for the tenure of their offices, and the amount and payment of their salaries.

flag is afctf{Whooooooo_U_Gotcha!}

He has erected a multitude of New Offices, and sent hither swarms of Officers to harass our people and eat out their substance.

He has kept among us, in times of peace, Standing Armies without the Consent of our legislatures.

He has affected to render the Military independent of and superior to the Civil Power.

He has combined with others to subject us to a jurisdiction foreign to our constitution, and unacknowledged by our laws; giving his Assent to their Acts of pretended Legislation:

For quartering large bodies of armed troops among us:

For protecting them, by a mock Trial from punishment for any Murders which they should commit on the Inhabitants of these States:

For cutting off our Trade with all parts of the world:

For imposing Taxes on us without our Consent:

For depriving us in many cases, of the benefit of Trial by Jury:

For transporting us beyond Seas to be tried for pretended offences:

For abolishing the free System of English Laws in a neighbouring Province, establishing therein an Arbitrary government, and enlarging its Boundaries so as to render it at once an example and fit instrument for introducing the same absolute rule into these Colonies

For taking away our Charters, abolishing our most valuable Laws and altering fundamentally the Forms of our Governments:

For suspending our own Legislatures, and declaring themselves invested with power to legislate for us in all cases whatsoever.

He has abdicated Government here, by declaring us out of his Protection and waging War against us.

He has plundered our seas, ravaged our coasts, burnt our towns, and destroyed the lives of our people.

He is at this time transporting large Armies of foreign Mercenaries to compleat the works of death, desolation, and tyranny, already begun with circumstances of Cruelty & Perfidy scarcely paralleled in the most barbarous ages, and totally unworthy the Head of a civilized nation.

He has constrained our fellow Citizens taken Captive on the high Seas to bear Arms against their Country, to become the executioners of their friends and Brethren, or to fall themselves by their Hands.

He has excited domestic insurrections amongst us, and has endeavoured to bring on the inhabitants of our frontiers, the merciless Indian Savages whose known rule of warfare, is an undistinguished destruction of all ages, sexes and conditions.

In every stage of these Oppressions We have Petitioned for Redress in the most humble terms: Our repeated Petitions have been answered only by repeated injury. A Prince, whose character is thus marked by every act which may define a Tyrant, is unfit to be the ruler of a free people.

Nor have We been wanting in attentions to our British brethren. We have warned them from time to time of attempts by their legislature to extend an unwarrantable jurisdiction over us. We have reminded them of the circumstances of our emigration and settlement here. We have appealed to their native justice and magnanimity, and we have conjured them by the ties of our common kindred to disavow these usurpations, which would inevitably interrupt our connections and correspondence. They too have been deaf to the voice of justice and of consanguinity. We must, therefore, acquiesce in the necessity, which denounces our Separation, and hold them, as we hold the rest of mankind, Enemies in War, in Peace Friends.

We, therefore, the Representatives of the united States of America, in General Congress, Assembled, appealing to the Supreme Judge of the world for the rectitude of our intentions, do, in the Name, and by Authority of the good People of these Colonies, solemnly publish and declare, That these united Colonies are, and of Right ought to be Free and Independent States, that they are Absolved from all Allegiance to the British Crown, and that all political connection between them and the State of Great Britain, is and ought to be totally dissolved; and that as Free and Independent States, they have full Power to levy War, conclude Peace, contract Alliances, establish Commerce, and to do all other Acts and Things which Independent States may of right do. â€” And for the support of this Declaration, with a firm reliance on the protection of Divine Providence, we mutually pledge to each other our Lives, our Fortunes, and our sacred Honor.
```

åœ¨ç ´è§£å¾—åˆ°æ–‡å­—ä¸­æ‰¾åˆ°flagï¼š

```txt
afctf{Whooooooo_U_Gotcha!}
```

## 0x2 [NPUCTF2020]è¿™æ˜¯ä»€ä¹ˆğŸ

çœ‹é¢˜ç›®åº”è¯¥æ˜¯ä¸ªè„‘æ´é¢˜ï¼Œå¤å…¸å¯†ç å­¦é¢˜ç›®ï¼Œç§ç§é™„ä»¶å§ï¼š

é™„ä»¶æ˜¯ä¸€ä¸ª`attachment`æ–‡ä»¶ï¼Œæ²¡æœ‰æ–‡ä»¶æ‰©å±•åâ€¦â€¦é‚£å°±å…ˆæ¢æµ‹ä¸€ä¸‹ï¼š

```bash
file attachment
```

å¾—åˆ°æ¢æµ‹è¾“å‡ºï¼š

```txt
attachment: Zip archive data, at least v2.0 to extract
```

åº”è¯¥æ˜¯ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œä¿®æ”¹æ–‡ä»¶åä¸º`attachment.zip`ï¼Œç„¶åè¿›è¡Œè§£å‹ï¼Œå¾—åˆ°äº†ä¸€ä¸ªå›¾ç‰‡ï¼š



![flag](/images/BUUCTF-CRYPTO-[64-80]_writeup/flag.jpg)

ï¼ˆè¿™æ˜¯æ‚é¡¹é¢˜ç›®ï¼Œè¶Šåšè¶Šä¸åƒå¯†ç å­¦ï¼‰

è¿™ä¸ªå›¾ç‰‡åº”è¯¥å°±æ˜¯å¯†ç ï¼Œè®¤çœŸè§‚å¯Ÿä¸€ä¸‹å›¾ç‰‡ï¼Œå‘ç°å›¾ç‰‡åº•éƒ¨æœ‰å¯†æ–‡ã€‚

å¯¹å¯†æ–‡è¿›è¡Œåˆ†æï¼š

1. æ—¥å†çš„å‘¨æ˜¯æŒ‰è‹±æ–‡æ¥è¿›è¡Œæ˜¾ç¤ºçš„
2. å¯†æ–‡æ•°ç»„ä¸­çš„é¦–å­—æ¯å¥½åƒå¯¹åº”ç€è‹±æ–‡çš„å‘¨

å› æ­¤å¯ä»¥æ ¹æ®ä»¥ä¸‹æ€è·¯è¿›è¡Œè§£é¢˜ï¼š

1. æ ¹æ®å¯†ç éœ€è¦å¯¹åº”æ•°å­—
2. å°†æ•°å­—æ˜ å°„åˆ°å­—æ¯è¡¨
3. è®²å­—æ¯æ‹¼æ¥

æ ¹æ®æ€è·¯ï¼Œå†™ä¸ªè„šæœ¬æ±‚è§£ï¼š

```python
import string
c = "F1 W1 S22 S21 T12 S11 W1 S13"
def encode_cal(data):
    encode_dict = {
            'M':[],
            'T1':[],
            'W':[],
            'T2':[],
            'F':[],
            'S1':[],
            'S2':[]
            }
    dict_index=['M','T1','W','T2','F','S1','S2']
    index = 2
    for i in range(30):
        encode_dict[dict_index[(index+i)%7]].append(i+1)

    result=""

    for m in data:
        if len(m)==2:
            result += string.ascii_lowercase[encode_dict[m[0]][int(m[1])-1]-1]
        elif len(m)==3:
            result += string.ascii_lowercase[encode_dict[m[0:2]][int(m[2])-1]-1]
    return result

if __name__ == "__main__":
    c_list = c.split(" ")
    flag = encode_cal(c_list)
    print(flag)
```

è¿è¡Œè„šæœ¬ï¼Œæ¸¸æˆç»“æŸï¼

```txt
calendar
```

## 0x3 easyrsa

rsaé¢˜ç›®ï¼Œæ¥ï¼Œè®©æˆ‘ä»¬æš´æ‰“å‡ºé¢˜äººï¼

é™„ä»¶æ˜¯ä¸ªpythonæºç ç¨‹åº

```python
from Crypto.Util.number import getPrime,bytes_to_long
from sympy import Derivative
from fractions import Fraction
from secret import flag

p=getPrime(1024)
q=getPrime(1024)
e=65537
n=p*q
z=Fraction(1,Derivative(arctan(p),p))-Fraction(1,Derivative(arth(q),q))
m=bytes_to_long(flag)
c=pow(m,e,n)
print(c,z,n)
'''
output:
7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035
32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482
15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441

'''
```

ç®€å•å®¡è®¡ä¸€ä¸‹ï¼Œå‘ç°å°±æ˜¯é“æ•°å­¦é¢˜ï¼Œå¾®åˆ†æ–¹ç¨‹çš„é¢˜ç›®ã€‚è¿™pythonç¨‹åºçš„å…³é”®ä»£ç ä¹Ÿåªæœ‰ä¸€è¡Œï¼š

```python
z=Fraction(1,Derivative(arctan(p),p))-Fraction(1,Derivative(arth(q),q))
```

åº”è¯¥å°±æ˜¯æ±‚è§£æ–¹ç¨‹çš„äº‹æƒ…ï¼Œå› ä¸ºæ¶‰åŠæ•°å­¦è¿ç®—ï¼Œæ‰€ä»¥å†™ä¸ªsageè„šæœ¬æ±‚è§£å§

```python
from Crypto.Util.number import long_to_bytes

c = 7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035
z = 32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482
n = 15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441
e = 65537

var('p, q')

f1 = (1/diff(arctan(p),p))-(1/diff(arctanh(q),q))
f2 = p*q

result = sorted(solve([f1==z,f2==n],(p,q)))
p = result[1][0]
q = result[1][1]
p =int(str(p)[5:])
q =int(str(q)[5:])

phi = (p-1)*(q-1)

d = inverse_mod(e,phi)
m = pow(c,d,n)
flag = long_to_bytes(m)
print(flag)  
```

> ç”±äºsagemathæ˜¯åŸºäºpython3çš„å¼€æºæ•°å­¦è½¯ä»¶ï¼Œè¿›è¡Œsageè¿è¡Œsageè„šæœ¬æ˜¯ä¼šè½¬æ¢æˆpythonæ ¼å¼è¿›è¡Œè¿è¡Œï¼Œä»£ç éå¸¸åƒpython3

è¿è¡Œè„šæœ¬ï¼Œæš´æ‰“å‡ºé¢˜äººï¼

```txt
b'BJD{Advanced_mathematics_is_too_hard!!!}'
```

## 0x4 babyRSA 

åˆä¸€ä¸ªRSAé¢˜ç›®ï¼Œå¸Œæœ›è¿™ä¸ªä¸å•å•åªæ˜¯æ•°å­¦è¿ç®—äº†ï¼Œçœ‹çœ‹é¢˜ç›®ï¼š

```python
from Crypto.Util.number import *
from flag import flag

def nextPrime(n):
    n += 2 if n & 1 else 1
    while not isPrime(n):
        n += 2
    return n

p = getPrime(1024)
q = nextPrime(p)
n = p * q
e = 0x10001
d = inverse(e, (p-1) * (q-1))
c = pow(bytes_to_long(flag.encode()), e, n)

# d = 19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913
# c = 5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804
```

è¿™é“é¢˜ç›®çš„è¾“å‡ºæ˜¯dã€cï¼Œåœ¨ç®—æ³•ç¨‹åºé‡Œé¢æš´éœ²å‡ºäº†eã€‚ä½†æ˜¯nä¸çŸ¥é“ï¼Œè¿™å°±æœ‰ç‚¹éº»çƒ¦äº†ã€‚ç®€å•æ¨å¯¼ä¸€ä¸‹å…¬å¼ï¼š
$$
\phi = (p-1)\times(q-1)
$$

$$
d \equiv e^{-1} \text{mod}\phi
$$

$$
d \cdot e \equiv 1\text{mod} \phi
$$

$$
d\cdot e -1 = k \cdot(p-1)\cdot(q-1)
$$
æ ¹æ®æ¨å¯¼ï¼Œå¯ä»¥è‚¯å®šçš„æ˜¯è¿™é“é¢˜ç›®éœ€è¦è¿›è¡Œçˆ†ç ´ã€‚ä¸ºäº†æé«˜çˆ†ç ´æ•ˆç‡ï¼Œéœ€è¦è¿›è¡Œç¼©å°èŒƒå›´æ¥è¿›è¡Œæ›´å¿«æ±‚è§£ã€‚ç¼©å°èŒƒå›´éœ€è¦å…ˆè¿›è¡Œåˆ¤æ–­ï¼špå’Œqéƒ½æ˜¯1024ä½ï¼Œnå°±æ˜¯2048ä½ã€‚è¿›è¡Œç®€å•çš„æµ‹è¯•å‘ç°ed-1æ˜¯2064ä½ï¼Œé‚£ä¹ˆå¯ä»¥åˆ¤æ–­å‡ºkä¸€å®šæ˜¯å°äº16ä½çš„ï¼Œæ ¹æ®ç›®å‰çš„æ¨æ–­æ¥å†™è„šæœ¬è¿›è¡Œæ±‚è§£ï¼š

```python
import libnum
import sympy
e = 0x10001
d = 19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913
c = 5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804

ed_1 = e*d-1
n = 0
for k in range(pow(2,15),pow(2,16)):
    if ed_1 % k == 0:
        phi = ed_1//k
        base = libnum.nroot(phi,2)
        p = sympy.nextprime(base)
        q = sympy.prevprime(base)
        if (p-1)*(q-1)*k == ed_1:
            n = p*q
            break

m = pow(c,d,n)
flag = libnum.n2s(m)
print flag
```

æ±‚è§£æ–¹å¼æ¯”è¾ƒæš´åŠ›ï¼Œæ‰§è¡Œè„šæœ¬å°±æ‹¿åˆ°flagäº†ï¼š

```txt
NCTF{70u2_nn47h_14_v3ry_gOO0000000d}
```

## 0x5 [AFCTF2018]ä½ èƒ½çœ‹å‡ºè¿™æ˜¯ä»€ä¹ˆåŠ å¯†ä¹ˆ 

è„‘æ´é¢˜ï¼Œçœ‹çœ‹é¢˜ç›®æ¨æµ‹ä¸€ä¸‹è¿™æ˜¯ä»€ä¹ˆåŠ å¯†ï¼š

```txt
p=0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f

q=0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061

e=0x10001

c=0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6
```

å¥½å¸¸è§„çš„RSAé¢˜ç›®ï¼Œè¿™æ˜¯ç­¾åˆ°é¢˜ç›®å§

å†™ä¸ªè„šæœ¬è§£å†³ï¼š

```python
import libnum

p=0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f

q=0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061

e=0x10001

c=0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6

phi = (p-1)*(q-1)

n = p*q

d = libnum.invmod(e,phi)

m = pow(c,d,n)
flag = libnum.n2s(m)

print flag
```

è¿è¡Œè„šæœ¬ï¼Œæ‹¿åˆ°flagï¼š

```txt
afctf{R54_|5_$0_$imp13}
```

## 0x6 [ACTFæ–°ç”Ÿèµ›2020]crypto-rsa3

RSAç®—æ³•çš„é¢˜ç›®ï¼Œæœ‰ç‚¹æ„æ€å“¦ï¼(\*\^\_\^\*)

ç…ä¸€ç…é¢˜ç›®é™„ä»¶ï¼š

æœ‰ä¸¤ä¸ªé™„ä»¶ï¼Œæ¯”è¾ƒå¸¸è§„çš„å½¢å¼ï¼Œä¸€ä¸ªæ˜¯`output.txt`çš„è¾“å‡ºæ–‡ä»¶ï¼Œä¸€ä¸ª`rsa3.py`çš„ç®—æ³•æ–‡ä»¶

rsa3.pyï¼š

```python
from flag import FLAG
from Cryptodome.Util.number import *
import gmpy2
import random

e=65537
p = getPrime(512)
q = int(gmpy2.next_prime(p))
n = p*q
m = bytes_to_long(FLAG)
c = pow(m,e,n)
print(n)
print(c)
```

output.txtï¼š

```txt
177606504836499246970959030226871608885969321778211051080524634084516973331441644993898029573612290095853069264036530459253652875586267946877831055147546910227100566496658148381834683037366134553848011903251252726474047661274223137727688689535823533046778793131902143444408735610821167838717488859902242863683
1457390378511382354771000540945361168984775052693073641682375071407490851289703070905749525830483035988737117653971428424612332020925926617395558868160380601912498299922825914229510166957910451841730028919883807634489834128830801407228447221775264711349928156290102782374379406719292116047581560530382210049
```

éå¸¸å¸¸è§„çš„RSAé¢˜ç›®ï¼Œç»™å‡ºäº†nï¼Œcï¼Œeã€‚åŠ å¯†ç®—æ³•ä¹Ÿæ¯”è¾ƒå¸¸è§„ï¼Œå…¶ä¸­på’Œqçš„æ•°å€¼æ¯”è¾ƒæ¥è¿‘ï¼Œå¯ä»¥ç›´æ¥å¯¹nå¼€æ–¹æ¥å¾—åˆ°på’Œqçš„æ•°å€¼ã€‚æ ¹æ®è¿™ä¸€æ€è·¯ï¼Œå†™ä¸ªè„šæœ¬æ±‚è§£ï¼š

```python
import libnum
import sympy
n = 177606504836499246970959030226871608885969321778211051080524634084516973331441644993898029573612290095853069264036530459253652875586267946877831055147546910227100566496658148381834683037366134553848011903251252726474047661274223137727688689535823533046778793131902143444408735610821167838717488859902242863683
c = 1457390378511382354771000540945361168984775052693073641682375071407490851289703070905749525830483035988737117653971428424612332020925926617395558868160380601912498299922825914229510166957910451841730028919883807634489834128830801407228447221775264711349928156290102782374379406719292116047581560530382210049
e = 65537

base = libnum.nroot(n,2)
p = sympy.prevprime(base)
q = sympy.nextprime(base)

assert(p*q == n)
phi = (p-1)*(q-1)
d = libnum.invmod(e,phi)
m = pow(c,d,n)
flag = libnum.n2s(m)
print flag
```

è¿è¡Œè„šæœ¬ï¼Œå¾—åˆ°flagï¼š

```txt
actf{p_and_q_should_not_be_so_close_in_value}
```

## 0x7 é¸¡è—•æ¤’ç›å‘³

é¢˜ç›®æ¯”è¾ƒå¥‡æ€ªï¼Œé‚£çœ‹çœ‹é¢˜ç›®ç©¶ç«Ÿä»€ä¹ˆæ ·çš„é¢˜ç›®å§ï¼š

```txt
å…¬å¸é£Ÿå ‚æœ€æ–°å‡ºäº†ä¸€ç§å°åƒï¼Œå«é¸¡è—•æ¤’ç›å‘³æ±‰å ¡ï¼Œå”®ä»·å…«å—é’±ï¼Œä¸ºäº†ä¿ƒé”€ï¼Œä¸Šé¢æœ‰ä¸€ä¸ªéªŒè¯ç ï¼Œè¾“å…¥åå¯ä»¥å†æ¢å–ä¸€ä¸ªæ±‰å ¡ã€‚ä½†æ˜¯é—®é¢˜æ˜¯æ¯ä¸ªéªŒè¯ç å‡ ä¹éƒ½æœ‰é”™è¯¯,è€Œä¸”æ‰“å°çš„æ—¶å€™å€’äº†ä¸€ä¸‹ã€‚å°æ˜ä¹°åˆ°äº†ä¸€ä¸ªæ±‰å ¡ï¼Œå‡†å¤‡è¿˜åŸéªŒè¯ç ï¼Œå› ä¸ºä¸€ä¸ªåƒä¸é¥±å•ŠéªŒè¯ç å¦‚ä¸‹ï¼š1100 1010 0000 ,è€Œä¸”æ‰“å°çš„æ—¶å€™å€’äº†ä¸€ä¸‹ã€‚æŠŠç­”æ¡ˆå“ˆå¸Œä¸€ä¸‹å°±å¯ä»¥æäº¤äº†ã€‚(ç­”æ¡ˆä¸ºæ­£ç¡®å€¼(ä¸åŒ…æ‹¬æ•°å­—ä¹‹é—´çš„ç©ºæ ¼)çš„32ä½md5å€¼çš„å°å†™å½¢å¼) æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤
```

å¯ä»¥ä»é¢˜ç›®ä¸­æç‚¼å‡ºä¸€äº›å…³é”®ä¿¡æ¯ï¼š

1. éªŒè¯ç ï¼š1100 1010 0000
2. æ‰“å°çš„æ—¶å€™å€’äº†ä¸€ä¸‹
3. å“ˆå¸Œæäº¤ã€‚(ç­”æ¡ˆä¸ºæ­£ç¡®å€¼(ä¸åŒ…æ‹¬æ•°å­—ä¹‹é—´çš„ç©ºæ ¼)çš„32ä½md5å€¼çš„å°å†™å½¢å¼)
4. è€Œä¸”æ‰“å°çš„æ—¶å€™å€’äº†ä¸€ä¸‹

è¿™äº›ä¿¡æ¯å’‹çœ‹ä¸å‡ºæ¥ä»€ä¹ˆä¸œè¥¿å‘€ï¼Œå˜¤å˜¤å˜¤~

ä»”ç»†çœ‹çœ‹é¢˜ç›®ï¼Œé¸¡è—•æ¤’ç›å‘³æ˜¯ä¸æ˜¯å¾ˆåƒæ˜¯å¥‡å¶æ ¡éªŒä½ï¼Œåº”è¯¥æ˜¯è¿™ä¸ªã€‚å¯ä»¥æ²¿ç€å¥‡å¶æ ¡éªŒä½çš„è¿™ä¸ªæ–¹å‘æ²¿ç€æ–¹å‘èµ°ä¸€ä¸‹ï¼Œçœ‹çœ‹èƒ½å¦æ‰¾åˆ°çªç ´çš„å…¥å£ã€‚æ²¿ç€å¥‡å¶æ ¡éªŒä½è¿›è¡Œæ¢ç´¢ï¼Œå‘ç°æœ‰ä¸ªæµ·æ˜æ ¡éªŒç çš„ä¸œè¥¿ï¼Œè€Œä¸”è¿˜æœ‰ä¸€ä¸ªæµ·æ˜çº é”™ç ã€‚è¿™é“é¢˜ç›®ï¼Œåº”è¯¥æ˜¯ä½¿ç”¨æµ·æ˜çº é”™ç æ¥è¿›è¡Œçº é”™çš„ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯æµ·æ˜ç å‘¢ï¼Ÿå¯ä»¥çœ‹çœ‹è¿™ç¯‡[çŸ¥ä¹æ–‡ç« ](https://zhuanlan.zhihu.com/p/278326197#:~:text=%E6%B5%B7%E6%98%8E%E7%A0%81%E5%88%A9%E7%94%A8%E7%9B%91%E7%9D%A3%E5%85%AC%E5%BC%8F%E5%AF%B9%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E4%BA%A4%E5%8F%89%E6%A0%A1%E9%AA%8C%EF%BC%8C%E5%88%A9%E7%94%A8%E7%9B%91%E7%9D%A3%E5%85%AC%E5%BC%8F%E7%9A%84%E7%89%B9%E6%80%A7%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E5%AE%9A%E4%BD%8D%E5%87%BA%E9%94%99%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BD%8D%E7%BD%AE%E3%80%82.%20%E5%9B%A0%E4%B8%BA%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE%E4%B8%AD%E6%95%B0%E6%8D%AE%E7%9A%84%E5%8F%96%E5%80%BC%E5%8F%AA%E6%9C%89%E4%B8%A4%E7%A7%8D%E7%8A%B6%E6%80%810%E5%92%8C1%EF%BC%8C%E5%9B%A0%E6%AD%A4%E5%8F%AA%E8%A6%81%E7%9F%A5%E9%81%93%E5%87%BA%E9%94%99%E7%9A%84%E4%BD%8D%E7%BD%AE%EF%BC%8C%E4%BF%AE%E6%94%B9%E5%B0%B1%E5%8F%98%E5%BE%97%E9%9D%9E%E5%B8%B8%E7%9A%84%E5%AE%B9%E6%98%93%EF%BC%8C%E5%8F%AA%E8%A6%81%E5%AF%B9%E5%87%BA%E9%94%99%E4%BD%8D%E7%BD%AE%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8F%96%E5%8F%8D%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%BE%BE%E5%88%B0%E7%BA%A0%E6%AD%A3%E7%9A%84%E7%9B%AE%E7%9A%84%E3%80%82.%20%E4%BE%8B%E5%A6%82%E6%8E%A5%E6%94%B6%E7%AB%AF%E6%94%B6%E4%BA%86%E4%B8%80%E4%B8%B2%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE101011%EF%BC%8C%E7%BB%8F%E8%BF%87%E6%B5%B7%E6%98%8E%E7%A0%81%E8%AE%A1%E7%AE%97%E5%90%8E%E5%BE%97%E5%88%B0%E7%9A%84%E6%95%B0%E5%AD%97%E6%98%AF3%EF%BC%8C%E8%AF%B4%E6%98%8E%E6%95%B0%E6%8D%AE%E4%B8%AD%E7%9A%84%E7%AC%AC3%E4%BD%8D%E7%9A%84%E6%95%B0%E6%8D%AE%E5%87%BA%E7%8E%B0%E4%BA%86%E9%94%99%E8%AF%AF%EF%BC%8C%E7%BA%A0%E6%AD%A3%E6%97%B6%E5%8F%AA%E9%9C%80%E8%A6%81%E6%8A%8A%E7%AC%AC%E4%B8%89%E4%BD%8D%E7%9A%841%E5%8F%96%E5%8F%8D%E5%8F%98%E6%88%900%E5%8D%B3%E5%8F%AF%EF%BC%8C%E7%BA%A0%E6%AD%A3%E5%90%8E%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%B8%B2%E6%98%AF100011%E3%80%82.,%E5%85%AC%E5%BC%8F%20%281%29%E4%B8%AD%E6%B5%B7%E6%98%8E%E7%A0%81%E8%99%BD%E7%84%B6%E5%8F%AF%E4%BB%A5%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E7%9A%84%E7%BA%A0%E9%94%99%EF%BC%8C%E4%BD%86%E6%98%AF%E5%8F%AA%E8%83%BD%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%AF%94%E7%89%B9%E6%95%B0%E6%8D%AE%E7%9A%84%E7%BA%A0%E9%94%99%E3%80%82.%20%E5%A6%82%E6%9E%9C%E6%95%B0%E6%8D%AE%E4%B8%AD%E6%9C%89%E5%A4%9A%E4%B8%AA%E6%AF%94%E7%89%B9%E5%90%8C%E6%97%B6%E5%87%BA%E7%8E%B0%E9%94%99%E8%AF%AF%EF%BC%8C%E5%B0%B1%E5%BF%85%E9%A1%BB%E4%BD%BF%E7%94%A8%E6%9B%B4%E5%8A%A0%E5%A4%8D%E6%9D%82%E7%9A%84%E6%B5%B7%E6%98%8E%E5%85%AC%E5%BC%8F%E3%80%82.)å¤§è‡´åŸç†éƒ½æœ‰äº†ï¼Œæ ¹æ®è¿™ç¯‡æ–‡ç« é˜è¿°çš„åŸç†è¿›è¡Œè„šæœ¬ç¼–å†™ï¼Œåº”è¯¥å°±å¯ä»¥æ‰¾å‡ºç­”æ¡ˆäº†ã€‚å†™ä¸‹è„šæœ¬ï¼š

```python
import hashlib

c = "110010100000"
c_r = c[::-1]
c_list =[]

for i in c_r:
    c_list.append(int(i))

h1 = c_list[2]^c_list[4]^c_list[6]^c_list[8]^c_list[10] ^ c_list[0]
h2 = c_list[2]^c_list[5]^c_list[6]^c_list[9]^c_list[10] ^ c_list[1]
h3 = c_list[4]^c_list[5]^c_list[6]^c_list[11] ^ c_list[3]
h4 = c_list[8]^c_list[9]^c_list[10]^c_list[11] ^ c_list[7]

mistake_bit = int(str(h4)+str(h3)+str(h2)+str(h1),2)
if c_list[mistake_bit-1]==1:
    c_list[mistake_bit-1] = 0
else:
    c_list[mistake_bit-1] = 1

m = ""
for i in c_list:
    m += str(i)
m = m[::-1]
flag = hashlib.md5(m).hexdigest()
print flag
```

è¿è¡Œä¸€ä¸‹è„šæœ¬ï¼Œflagå°±æœ‰äº†ï¼š

```txt
d14084c7ceca6359eaac6df3c234dd3b
```

##  0x8 [ACTFæ–°ç”Ÿèµ›2020]crypto-classic0

çœ‹é¢˜ç›®å°±çŸ¥é“ï¼Œè¿™ä¸ªæ˜¯å¤å…¸å¯†ç å­¦çš„é¢˜ç›®ï¼Œçœ‹çœ‹ç©¶ç«Ÿæ˜¯åœ¨è€ƒå¯Ÿäº›ä»€ä¹ˆå¤å…¸å¯†ç å§ï¼š

é™„ä»¶æ–‡ä»¶é‡Œé¢æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ª`cipher`æ–‡æœ¬æ–‡ä»¶ï¼Œä¸€ä¸ª`hint.txt`æç¤ºæ–‡ä»¶å’Œä¸€ä¸ª`howtoencrypt.zip`åŠ å¯†å‹ç¼©æ–‡ä»¶ã€‚

hint.txt:

```txt
å“¼ï¼Œå‹ç¼©åŒ…çš„å¯†ç ï¼Ÿè¿™æ˜¯å°Zç«¥é‹çš„ç”Ÿæ—¥å§==
```

åº”è¯¥æ˜¯å‹ç¼©åŒ…æ–‡ä»¶çš„æç¤ºå†…å®¹

å¦ä¸€ä¸ªcipheræ–‡ä»¶éœ€è¦è¿›è¡Œæ¢æµ‹ä¸€ä¸‹ï¼Œä½¿ç”¨`file`å‘½ä»¤ç®€å•æ¢æµ‹ä¸€ä¸‹

```txt
cipher: International EBCDIC text, with no line terminators
```

æ˜¯ä¸€ä¸ªçº¯æ–‡æœ¬æ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨è®°äº‹æœ¬ç›´æ¥æ‰“å¼€ï¼š

```txt
Ygvdmq[lYate[elghqvakl}
```

è¿™ä¸ªæç¤ºåº”è¯¥å‘Šè¯‰å‹ç¼©æ–‡ä»¶çš„å¯†ç é•¿åº¦ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨å‹ç¼©çˆ†ç ´å·¥å…·è¿›è¡Œçˆ†ç ´ï¼Œç»è¿‡çˆ†ç ´å¯ä»¥å¾—åˆ°å¯†ç æ˜¯`19990306`ã€‚ä½¿ç”¨å¯†ç è¿›è¡Œè§£å‹å¾—åˆ°ä¸€ä¸ªcè¯­è¨€æºç¨‹åºï¼Œåº”è¯¥æ˜¯åŠ å¯†ç®—æ³•ã€‚

classic0.cï¼š

```c
#include<stdio.h>

char flag[25] = ***

int main()
{
	int i;
	for(i=0;i<25;i++)
	{
		flag[i] -= 3;
		flag[i] ^= 0x7;
		printf("%c",flag[i]);
	}
	return 0; 
}
```

æ ¹æ®è¿™ä¸ªcç¨‹åºç®—æ³•è®¾è®¡ä¸€ä¸ªé€†ç®—æ³•åº”è¯¥å°±å¯ä»¥è¿›è¡Œæ±‚è§£ï¼Œè¿™é‡Œå†™ä¸ªcè¯­è¨€é€†ç®—æ³•ï¼š

```c
#include <stdio.h>
int main()
{
    char flag[25];
    FILE *fp = NULL;
    fp = fopen("cipher.txt","r");
    fgets(flag,25,fp);

    for(int i=0;i<25;i++)
    {
        flag[i] ^= 0x7;
        flag[i] += 3;
        printf("%c", flag[i]);
    }
    fclose(fp);
    return 0;
}
```

ç¼–è¯‘å¹¶æ‰§è¡Œå¾—åˆ°flagï¼š

```txt
actf{my_naive_encrytion}
```

##  0x9 [RoarCTF2019]babyRSA

RSAé¢˜ç›®ï¼Œçœ‹çœ‹è¿™æ¬¡åˆæœ‰ä»€ä¹ˆæ ·çš„æƒŠå–œï¼

```python
import sympy
import random

def myGetPrime():
    A= getPrime(513)
    print(A)
    B=A-random.randint(1e3,1e5)
    print(B)
    return sympy.nextPrime((B!)%A)
p=myGetPrime()
#A1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407
#B1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596

q=myGetPrime()
#A2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927
#B2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026

r=myGetPrime()

n=p*q*r
#n=85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733
c=pow(flag,e,n)
#e=0x1001
#c=75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428
#so,what is the flag?
```

ä»£ç æŒºé•¿çš„ï¼Œè€ƒå¯Ÿçš„å†…å®¹æ˜¯é˜¶ä¹˜ï¼Ÿæ˜¯ä¸æ˜¯è¦è€ƒè™‘ä¸€ä¸‹é€’å½’çš„æ–¹å¼è¿›è¡Œæ±‚è§£ï¼Ÿé‚£ä¼°è®¡æ…¢çš„ä¸å¾—äº†ï¼Œè‚¯å®šæœ‰æ›´å¥½çš„ç®—æ³•è¿›è¡Œæ±‚è§£ï¼Œåƒåœ¾çš„æˆ‘å»ç¿»ç¿»äº†ç‹å°äº‘é™¢å£«å†™çš„æ•°å­¦ä¹¦ï¼Œå‘ç°æœ‰ä¸ªå«å¨å°”é€Šå®šç†çš„ä¸œè¥¿å¯ä»¥ç”¨äºç®—æ³•çš„æ±‚è§£ï¼Œè¿™é“é¢˜ç›®å°±æ˜¯è€ƒå¯Ÿå¨å°”é€Šå®šç†çš„å†…å®¹ã€‚

å¨å°”é€Šå®šç†çš„å†…å®¹å¾ˆç®€å•ï¼š
$$
(p-1)! \equiv -1 (\text{mod} p)
$$
å…¶ä¸­pä¸ºç´ æ•°

æ ¹æ®å¨å°”é€Šå®šç†å°±å¯ä»¥å¯¹è¿™é“é¢˜ç›®è¿›è¡Œç®€å•çš„æ¨å¯¼æ±‚è§£ï¼š

é¦–å…ˆï¼Œäº†è§£ä¸€ä¸‹ç®—æ³•çš„åŠ å¯†è¿‡ç¨‹ï¼š
$$
p \equiv B_1! \text{mod}A_1
$$

$$
q\equiv B_2! \text{mod}A_2
$$

$$
r \equiv B_3! \text{mod}A_3
$$

$$
n = p \cdot q \cdot r
$$

$$
c \equiv m ^e \text{mod} n
$$

åŠ å¯†è¿‡ç¨‹ä¹Ÿæ˜¯éå¸¸æ¸…æ™°ï¼Œé—®é¢˜æ˜¯å¦‚ä½•æ›´å¿«åœ°è®¡ç®—å‡ºpå’Œqçš„æ•°å€¼ï¼Œè¿™é‡Œå°±éœ€è¦ç”¨åˆ°å¨å°”é€Šå®šç†æ¥è¿›è¡Œç›¸åº”çš„è®¡ç®—ï¼š

æ ¹æ®ä»£ç ä¸­çš„ç®—æ³•ï¼Œå¯ä»¥çœ‹å‡ºæœ‰ä¸€å¥ä»£ç è¡¨æ˜ï¼š

```python
B=A-random.randint(1e3,1e5)
```

å› æ­¤ï¼Œè¿™é‡Œå¯ä»¥æ ¹æ®è¿™ä¸€ä¿¡æ¯ä½¿ç”¨å¨å°”é€Šå®šç†è¿›è¡Œæ¨å¯¼ï¼š
$$
(A-1)! \equiv -1\text{mod}A
$$

$$
(A-1)\cdot(A-2)\cdot(A-3)\dots(B+1)\cdot(B)\dots2\cdot1\equiv-1\text{mod} A
$$

$$
(A-1)\cdot(A-2)\cdot(A-3)\dots(B+1)\cdot(B!)\equiv-1\text{mod} A
$$

$$
(A-1)\cdot(A-2)\cdot(A-3)\dots(B+1)\cdot(B!)\equiv(A-1)\text{mod} A
$$

$$
(A-2)\cdot(A-3)\dots(B+1)\cdot(B!)\equiv1\text{mod} A
$$

å› æ­¤è¦æ±‚`(B!)%A`å¯ä»¥é€šè¿‡æ±‚$(A-2)\cdot(A-1)\dots(B+1)$çš„é€†å…ƒæ¥è¿›è¡Œä¼˜åŒ–æ±‚è§£ï¼Œæé«˜è¿ç®—çš„æ•ˆç‡ï¼Œè¿™æ ·åˆ†æå®Œï¼Œè¿™é“é¢˜ç›®çš„å¤§è‡´æ€è·¯ä¹Ÿå°±æœ‰äº†ã€‚æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œå†™ä¸ªè„šæœ¬æ±‚è§£å°±å¥½ï¼š

```python
import libnum
import sympy

def wilson(A,B):
    tmp = 1
    for i in range(B+1,A-1):
        tmp *= i
        tmp %= A
    tmp_inv = libnum.invmod(tmp,A)
    result = sympy.nextprime(tmp_inv)
    return result

A1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407
B1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596
A2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927
B2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026
n=85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733
e=0x1001
c=75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428
p = wilson(A1, B1)
q = wilson(A2, B2)
r = n //(p*q)
phi = (p-1)*(q-1)*(r-1)

d = libnum.invmod(e,phi)
m = pow(c,d,n)
flag = libnum.n2s(m)
print flag
```

è¿è¡Œè„šæœ¬ï¼Œæ‹¿åˆ°flag

```txt
RoarCTF{wm-CongrAtu1ation4-1t4-ju4t-A-bAby-R4A}
```

è¿™é“é¢˜ç›®è¿˜æ˜¯æŒºæœ‰æ„æ€çš„ï¼Œè€ƒçš„å†…å®¹æ¯”è¾ƒç»¼åˆï¼Œæ˜¯ä¸€é“ä¸é”™çš„RSAé¢˜ç›®ã€‚

## 0xA [AFCTF2018]å¯æ€œçš„RSA

è¿™æ¬¡åˆæœ‰ä»€ä¹ˆèŠ±æ ·å‘¢ï¼Ÿå¯æ€œçš„RSA

ç§ç§é¢˜ç›®ï¼š

é™„ä»¶é‡Œé¢æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ª`flag.enc`çš„å¯†æ–‡æ–‡ä»¶å’Œä¸€ä¸ª`public.enc`çš„å…¬é’¥æ–‡ä»¶

è¿™é“é¢˜ç›®çš„æ€è·¯åº”è¯¥æ˜¯è¯»å–å…¬é’¥æ–‡ä»¶ï¼Œç„¶åå¯¹å…¬é’¥æ–‡ä»¶ä¸­çš„modulusè¿›è¡Œå¤§æ•°åˆ†è§£ï¼Œæœ€åä½¿ç”¨å®é™…åº”ç”¨çš„ä¼šç”¨åˆ°çš„å¡«å……æ–¹æ³•è¿›è¡Œè§£å¯†ã€‚

æ€è·¯å¾ˆç®€å•ï¼Œæ ¹æ®æ€è·¯å†™ä¸ªè„šæœ¬ï¼š

```python
from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_OAEP
from base64 import b64decode
from sympy.ntheory.factor_ import smoothness
import sympy
import libnum

with open("public.key","rb") as f:
    rsakey = RSA.importKey(f.read())
    n = rsakey.n
    e = rsakey.e

result = sympy.factorint(n)
p = long(result.keys()[0])
q = long(result.keys()[1])

phi = (p-1)*(q-1)
d = libnum.invmod(e,phi)

key_info = RSA.construct((n,e,d,p,q))
key = RSA.importKey(key_info.exportKey())
key = PKCS1_OAEP.new(key)

with open("flag.enc","rb") as f:
    c = b64decode(f.read())
    flag = key.decrypt(c)

print flag
```

è¿è¡Œè„šæœ¬ï¼Œå¾—åˆ°flagï¼š

```txt
afctf{R54_|5_$0_B0rin9}
```

è¿™é“é¢˜ç›®æ¯”è¾ƒåå‘äºåº”ç”¨æ–¹é¢ï¼Œæ¶‰åŠåˆ°äº†RSAçš„åŠ å¯†ç®—æ³•å¡«å……æ–¹æ³•ï¼Œä¸å†æ˜¯è£¸éœ²å†å¤–é¢çš„RSAç®—æ³•ã€‚å¯ä»¥è¿›ä¸€æ­¥äº†è§£ä¸€ä¸‹ã€‚

 ## 0xB æ•‘ä¸»æ·å¾„

æ•‘ä¸»æ·å¾„ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªè„‘æ´é¢˜ç›®ï¼Œçœ‹çœ‹é¢˜ç›®ï¼š

```txt
ä¸€ä¸ªåå«CPUçš„ç¥ç§˜å¤§é™†æœ‰26ä¸ªå›½å®¶ï¼Œæœ‰äº›å›½å®¶ä¹‹é—´ä¼šæœ‰ä¸€æ¡æ— å‘è·¯ï¼Œæ¯æ¡è·¯å¾„éƒ½æœ‰ä¸åŒçš„é•¿åº¦å’Œä¸€æ®µç¥ç§˜ä»£ç ï¼Œæ•‘ä¸–ä¸»å°¼å¥¥è¦ä»å›½å®¶1å‡ºå‘ï¼Œèµ¶å¾€å›½å®¶26æ‹¯æ•‘å¤§é™†ï¼Œè¯·ä½ å¸®åŠ©æ•‘ä¸–ä¸»é€‰æ‹©æœ€çŸ­è·¯å¾„ï¼Œè€Œèµ°è¿‡çš„è·¯çš„ç¥ç§˜ä»£ç è¿æ¥èµ·æ¥ä¾¿æ˜¯flagã€‚ ä»¥ä¸‹æ˜¯æ•°è¡Œæ•°æ®ï¼Œæ¯è¡Œç¬¬ä¸€ä¸ªï¼Œç¬¬äºŒä¸ªæ•°å­—ä»£è¡¨è¿™æ¡è·¯çš„ä¸¤ä¸ªç«¯ç‚¹å›½å®¶ï¼Œç¬¬ä¸‰ä¸ªæ•°å­—ä»£è¡¨è·¯é€”é•¿åº¦ï¼Œæœ€åä¸€ä¸ªå­—ç¬¦ä¸²ä¾¿æ˜¯ç¥ç§˜ä»£ç ã€‚è·¯åœ¨é™„ä»¶ä¸­~ å¸®åŠ©æ•‘ä¸–ä¸»å°¼å¥¥å§ï¼Œä»–å¿«è¢«å“å°¿äº†ã€‚ã€‚ã€‚ æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤
```

çœ‹æ ·å­åº”è¯¥æ˜¯å¹¿åº¦ä¼˜å…ˆç®—æ³•çš„åº”ç”¨ï¼Œé¢˜ç›®ä¸­åªè¯´åˆ°äº†è·ç¦»ï¼Œæ²¡æœ‰æ¶‰åŠæƒé‡ï¼Œåº”è¯¥å°±æ˜¯å¹¿åº¦ä¼˜å…ˆç®—æ³•ï¼Œçœ‹çœ‹é™„ä»¶æ˜¯ä»€ä¹ˆå§ï¼

```
1 2 100 FLAG{
2 3 87 AFQWE
2 4 57 ETKLS
2 5 50 WEIVK
2 6 51 AWEIW
3 7 94 QIECJF
3 8 78 QSXKE
3 9 85 QWEIH
4 13 54 WQOJF
4 14 47 KDNVE
4 15 98 QISNV
5 10 43 AEWJV
5 11 32 QWKXF
5 12 44 ASJVL
6 16 59 ASJXJ
6 17 92 QJXNV
6 18 39 SCJJF
6 23 99 SJVHF
7 19 99 WJCNF
8 20 96 SKCNG
9 20 86 SJXHF
10 21 60 SJJCH
11 21 57 SJHGG
12 22 47 SJCHF
14 10 55 EJFHG
16 17 59 ASJVH
18 12 53 SJFHG
18 24 93 SHFVG
21 22 33 SJFHB
19 25 88 ASHHF
20 25 96 SJVHG
22 25 23 SJVHJ
25 26 75 SDEV}
```

æ ¹æ®é™„ä»¶æ–‡ä»¶ç»˜åˆ¶ä¸ªå›¾ï¼Œä¹Ÿæ–¹ä¾¿è¿›è¡Œå¹¿åº¦ä¼˜å…ˆç®—æ³•çš„ä½¿ç”¨å’Œè®¡ç®—ï¼š

![image-20210630202812243](/images/BUUCTF-CRYPTO-[64-80]_writeup/image-20210630202812243.png)

æ ¹æ®å›¾ç¤ºæ¥ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆç®—æ³•çš„è®¾è®¡ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨æ¯”è¾ƒç»å…¸çš„Dijkstraç®—æ³•æ¥æ±‚è§£æœ€ä¼˜é—®é¢˜ï¼Œä½¿ç”¨pythonè¿›è¡Œç®—æ³•å®ç°ï¼š

```python
import networkx as nx

def Dijkstra(G, start, end):
    RG = G.reverse();
    dist = {};
    previous = {}
    for v in RG.nodes():
        dist[v] = float('inf')
        previous[v] = 'none'
    dist[end] = 0
    u = end
    while u != start:
        u = min(dist, key=dist.get)
        distu = dist[u]
        del dist[u]
        for u, v in RG.edges(u):
            if v in dist:
                alt = distu + RG[u][v]['weight']
                if alt < dist[v]:
                    dist[v] = alt
                    previous[v] = u
    path = (start,)
    last = start
    while last != end:
        nxt = previous[last]
        path += (nxt,)
        last = nxt
    return path

G = nx.DiGraph()
datalist = []
datadict = {}
with open("data.txt","rb") as f:
    lines = f.readlines()
    for line in lines:
        line = line.strip("\r\n")
        datalist.append(line)

for i in datalist:
    data = i.split(" ")
    datadict[data[0]+"-"+data[1]] = data[3]
    G.add_edge(int(data[0]),int(data[1]),weight=int(data[2]))
rs = Dijkstra(G, 1, 26)
flag = ""
for i in range(len(rs)-1):
    flag += datadict[str(rs[i])+"-"+str(rs[i+1])]

print flag
print flag.lower()
```

è¿è¡Œè„šæœ¬ï¼Œå³å¯è·å¾—flagï¼š

```txt
FLAG{WEIVKASJVLSJCHFSJVHJSDEV}
flag{weivkasjvlsjchfsjvhjsdev}
```

## 0xC [ç½‘é¼æ¯ 2020 é’é¾™ç»„]boom

è¿™é“é¢˜ç›®ï¼Œboomçš„æ„æ€çˆ†ç‚¸ï¼Œè¿™é“é¢˜ç›®åº”è¯¥ä¼šæœ‰ç‚¹æ„æ€ã€‚

æ¥çœ‹çœ‹é¢˜ç›®å‘€ï¼š

çœ‹åˆ°é™„ä»¶å†…å®¹æ˜¯ä¸€ä¸ªexeæ–‡ä»¶ï¼Œå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæœ‰ç‚¹åƒæ˜¯é€†å‘é¢˜ç›®ã€‚é¦–å…ˆæ‰§è¡Œä¸€ä¸‹exeç¨‹åºï¼Œçœ‹çœ‹ç¨‹åºä¼šç»™æˆ‘ä»¬å±•ç¤ºä»€ä¹ˆæ ·çš„æ•ˆæœï¼Ÿ

![image-20210630213025137](/images/BUUCTF-CRYPTO-[64-80]_writeup/image-20210630213025137.png)

æŒ‰ä¸€ä¸‹ä»»æ„é”®ï¼š

![image-20210630213049828](/images/BUUCTF-CRYPTO-[64-80]_writeup/image-20210630213049828.png)

åº”è¯¥æ˜¯ä¸€ä¸ªè¿›è¡Œç­”é¢˜çš„exeç¨‹åºï¼Œè¿™é‡Œæœ‰ä¸¤æ¡è·¯å¯ä»¥èµ°ï¼Œç¬¬ä¸€æ¡è·¯å°±æ˜¯é€šè¿‡ç­”é¢˜æ¥æ‹¿åˆ°flagï¼Œè€Œç¬¬äºŒæ¡è·¯å°±æ˜¯é€šè¿‡é€†å‘å·¥å…·è¿›è¡Œé€†å‘ã€‚ä¸‹é¢ç»˜åˆ¶ä¸€ä¸ªæ‹“æ‰‘å›¾æ¥çœ‹çœ‹è¿™é“é¢˜ç›®çš„æ€è·¯ï¼š

![image-20210630214244533](/images/BUUCTF-CRYPTO-[64-80]_writeup/image-20210630214244533.png)

æ— è®ºæ€ä¹ˆèµ°ï¼Œéƒ½éœ€è¦è§£å†³é¢˜ç›®çš„é—®é¢˜ï¼Œè¿™é“é¢˜ç›®çš„æœ¬æ„åº”è¯¥æ˜¯è€ƒå¯Ÿæ•°å­¦æŠ€èƒ½ï¼Œè¿™é“é¢˜ç›®å°±ä½¿ç”¨IDAé€†å‘å·¥å…·è¿›è¡Œåˆ†æï¼Œæ‰“å¼€IDAçœ‹åˆ°ä¼ªä»£ç ï¼š

```c
int __cdecl main(int argc, const char **argv, const char **envp)
{
  int v3; // eax
  char Str[50]; // [esp+24h] [ebp-128h] BYREF
  unsigned __int8 v6[50]; // [esp+56h] [ebp-F6h] BYREF
  _DWORD v7[16]; // [esp+88h] [ebp-C4h]
  unsigned int v8[22]; // [esp+C8h] [ebp-84h] BYREF
  __int64 v9; // [esp+120h] [ebp-2Ch] BYREF
  int v10; // [esp+12Ch] [ebp-20h] BYREF
  int v11; // [esp+130h] [ebp-1Ch] BYREF
  int v12; // [esp+134h] [ebp-18h] BYREF
  int v13; // [esp+138h] [ebp-14h]
  int i; // [esp+13Ch] [ebp-10h]

  __main();
  menu();
  system("pause");
  system("cls");
  v7[0] = 70;
  v7[1] = 229;
  v7[2] = 239;
  v7[3] = 230;
  v7[4] = 22;
  v7[5] = 90;
  v7[6] = 90;
  v7[7] = 251;
  v7[8] = 54;
  v7[9] = 18;
  v7[10] = 23;
  v7[11] = 68;
  v7[12] = 106;
  v7[13] = 45;
  v7[14] = 189;
  v7[15] = 1;
  puts("first:this string md5:46e5efe6165a5afb361217446a2dbd01");
  scanf("%s", Str);
  MD5Init(v8);
  v3 = strlen(Str);
  MD5Update((int)v8, Str, v3);
  MD5Final(v8, v6);
  v13 = 1;
  for ( i = 0; i <= 15; ++i )
  {
    if ( v6[i] != v7[i] )
    {
      v13 = 0;
      break;
    }
  }
  if ( v13 != 1 )
  {
    printf("Game over");
    system("pause");
    exit(0);
  }
  puts("Great next level");
  system("pause");
  system("cls");
  puts("This time:Here are have some formulas");
  puts("3x-y+z=185");
  puts("2x+3y-z=321");
  puts("x+y+z=173");
  printf("input: x = ");
  scanf("%d", &v12);
  printf("input: y = ");
  scanf("%d", &v11);
  printf("input : z = ");
  scanf("%d", &v10);
  if ( 3 * v12 - v11 + v10 != 185 || 2 * v12 + 3 * v11 - v10 != 321 || v11 + v12 + v10 != 173 )
  {
    printf("Game over");
    exit(0);
  }
  printf("Great last level coming...");
  printf("pause");
  system("cls");
  puts("Last time: Kill it");
  puts("x*x+x-7943722218936282=0");
  printf("input x: ");
  scanf("%lld", &v9);
  if ( v9 * (v9 + 1) != 0x1C38C5F50DD7DALL )
  {
    printf("Game over");
    exit(0);
  }
  puts("Great This is your FLAG");
  return 0;
}
```

å¯ä»¥ä»é€†å‘çš„ä¼ªä»£ç ä¸­æ‰¾åˆ°ä¸€äº›æ¯”è¾ƒå…³é”®çš„ä»£ç ï¼š

åŸå§‹å†…å­˜æ•°æ®

```c
  system("pause");
  system("cls");
  v7[0] = 70;
  v7[1] = 229;
  v7[2] = 239;
  v7[3] = 230;
  v7[4] = 22;
  v7[5] = 90;
  v7[6] = 90;
  v7[7] = 251;
  v7[8] = 54;
  v7[9] = 18;
  v7[10] = 23;
  v7[11] = 68;
  v7[12] = 106;
  v7[13] = 45;
  v7[14] = 189;
  v7[15] = 1;
```

level 1å…³é”®ä»£ç 

```c
puts("first:this string md5:46e5efe6165a5afb361217446a2dbd01");
  scanf("%s", Str);
  MD5Init(v8);
  v3 = strlen(Str);
  MD5Update((int)v8, Str, v3);
  MD5Final(v8, v6);
  v13 = 1;
  for ( i = 0; i <= 15; ++i )
  {
    if ( v6[i] != v7[i] )
    {
      v13 = 0;
      break;
    }
  }
  if ( v13 != 1 )
  {
    printf("Game over");
    system("pause");
    exit(0);
  }
  puts("Great next level");
  system("pause");
  system("cls");
```

level 2å…³é”®ä»£ç 

```c
  puts("This time:Here are have some formulas");
  puts("3x-y+z=185");
  puts("2x+3y-z=321");
  puts("x+y+z=173");
  printf("input: x = ");
  scanf("%d", &v12);
  printf("input: y = ");
  scanf("%d", &v11);
  printf("input : z = ");
  scanf("%d", &v10);
  if ( 3 * v12 - v11 + v10 != 185 || 2 * v12 + 3 * v11 - v10 != 321 || v11 + v12 + v10 != 173 )
  {
    printf("Game over");
    exit(0);
  }
  printf("Great last level coming...");
  printf("pause");
  system("cls");
```

level 3å…³é”®ä»£ç 

```c
  puts("Last time: Kill it");
  puts("x*x+x-7943722218936282=0");
  printf("input x: ");
  scanf("%lld", &v9);
  if ( v9 * (v9 + 1) != 0x1C38C5F50DD7DALL )
  {
    printf("Game over");
    exit(0);
  }
  puts("Great This is your FLAG");
  return 0;
}
```

æ ¹æ®ä¸‰ä¸ªå…³é”®ä»£ç è¿›è¡Œä»£ç å®¡è®¡ï¼Œä»£ç å®¡è®¡è¿˜æ˜¯è€åŸºæœ¬åŠŸäº†

level 1çš„å…³é”®ä»£ç æ˜¯åˆ¤æ–­md5å€¼çš„ï¼Œä½¿ç”¨[cmd5]([md5åœ¨çº¿è§£å¯†ç ´è§£,md5è§£å¯†åŠ å¯† (cmd5.com)](https://cmd5.com/))å°±å¯ä»¥è§£å‡ºï¼Œå³ï¼š

```c
Str = "en5oy";
```

level 2çš„å…³é”®ä»£ç æ˜¯è§£æ–¹ç¨‹ç»„ï¼Œä½¿ç”¨sageæ±‚è§£ï¼š

```python
var("x y z") 
solve([3*x-y+z==185,2*x+3*y-z==321,x+y+z==173],x,y,z)
```

è¿è¡Œå°±å¯ä»¥æ±‚è§£å¾—å‡ºxï¼Œyå’Œzçš„å€¼ï¼š

```python
[[x == 74, y == 68, z == 31]]
```

å› æ­¤ï¼Œå¯ä»¥å¾—åˆ°ï¼š

```c
v12 == 74;
v11 == 68;
v10 == 31;
```

leve 3çš„å…³é”®ä»£ç å°±æ˜¯è§£ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹æˆ–è€…å¯ä»¥ç®€åŒ–ï¼Œå°±æ˜¯è§£`v9 * (v9 + 1) == 7943722218936282`ï¼Œå¯ä»¥ä½¿ç”¨sageç›´æ¥è¿›è¡Œæ±‚è§£ï¼š

```python
 solve(x * (x + 1) == 7943722218936282,x)
```

è¿è¡Œå¯å¾—ï¼š

```python
 [x == 89127561, x == -89127562]
```

ç”±æ­¤ï¼Œå¯ä»¥å¾—åˆ°ï¼š

```c
v9 == 89127561;
```

ç„¶åè¿›è¡Œç»„åˆå°±å¯ä»¥å¾—åˆ°flagï¼š

```
flag{en5oy_746831_89127561}
```

##  0xD [RoarCTF2019]RSA

åˆæ¥äº†ä¸€é“RSAé¢˜ç›®ï¼Œçœ‹çœ‹æœ‰äº›ä»€ä¹ˆä¸œè¥¿å§ï¼

```txt
A=(((y%x)**5)%(x%y))**2019+y**316+(y+1)/x
p=next_prime(z*x*y)
q=next_prime(z)
A =  2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724
n =  117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127
c =  41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128
```

è¿™é“é¢˜ç›®æ¶‰åŠåˆ°äº†æ¨¡çº¿æ€§æ–¹ç¨‹ï¼Œéœ€è¦è€ƒè™‘æ¨¡çº¿æ€§æ–¹ç¨‹è¯¥å¦‚ä½•è¿›è¡Œæ±‚è§£ã€‚ç›®å‰ï¼Œæˆ‘å°šæœªæ‰¾åˆ°é™¤äº†çˆ†ç ´å¤–çš„è§£æ³•ï¼Œå› æ­¤ï¼Œè¿™æ¬¡å°±ç”¨çˆ†ç ´æ¥æ±‚è§£ï¼Œä½†æ˜¯è¦ç”¨çˆ†ç ´æ±‚è§£å°±å¿…ç„¶éœ€è¦è€ƒè™‘çˆ†ç ´æ—¶é—´ï¼Œå¦‚ä½•æ¥ç¼©çŸ­çˆ†ç ´æ—¶é—´ã€‚

å†æ¥çœ‹çœ‹é¢˜ç›®ï¼š

é¢˜ç›®ç»™å®šäº†$A$ ã€$n$ ã€$c$ ï¼Œä¸”æ»¡è¶³

$$
A = [ (y \text{ % } x ) ^ 5 \text{ % } ( x \text{ % } y ) ] ^ {2019} + y ^ {316} + \frac{y+1}{x}
$$

æ ¹æ®æ–¹ç¨‹å¯ä»¥å¾—çŸ¥ $x | y+1$ å› æ­¤ï¼Œå¯ä»¥æ¨æ–­å‡ºæ¥ $ y \equiv -1 \text{mod}x$ ã€‚è€Œä¸”ç”±äº $ y+1$ æ¯” $x$ å¤§ï¼Œå› æ­¤ï¼Œåº”è¯¥æœ‰$x\%y=x$ ã€‚äºæ˜¯ï¼š

$$
[(y\text{ % }x)^5\text{ % }(x\text{ % }y)]^{2019} = (x-1)^{2019}
$$

å› æ­¤ï¼Œå¯ä»¥å¾—åˆ°ï¼š

$$
A = (x-1)^{2019} + y^{316} + \frac{y+1}{x}
$$

é€šè¿‡è§‚å¯Ÿå‘ç°$A$çš„å€¼æ˜¯ä¸€ä¸ª2015ä¸ªbitçš„æ•°ã€‚è€Œä¸”ï¼š

$$
A \geq (x-1)^{2019}
$$

æ˜¾ç„¶åªæœ‰ï¼š

$$
x \leq 2
$$

å› æ­¤è¿›è¡Œè®¨è®º$x=1 $å’Œ$x =2$è¿™ä¸¤ç§æƒ…å†µæ—¶ï¼Œå‘ç°å­˜åœ¨æœ‰å”¯ä¸€è§£ï¼Œå³ï¼š

$$
(x,y) = (2,83)
$$

ç°åœ¨$ x $å’Œ$ y $çŸ¥é“äº†ï¼Œçœ‹ä¸€ä¸‹ç®—æ³•çš„å…¶ä»–ç»†èŠ‚å§

```python
p=next_prime(z*x*y)
q=next_prime(z)
```

ç”±äºå·²ç»çŸ¥é“äº†$x$å’Œ$y$ ï¼Œå› æ­¤ï¼Œå¯ä»¥çŸ¥é“ï¼š
$$
n = p \cdot q
$$

$$
n = z\cdot x \cdot y \cdot z
$$

å› æ­¤å¯ä»¥æ¨å‡ºï¼š
$$
q \approx \sqrt{\frac{n}{x\cdot y}}
$$

$$
p \approx x\cdot y \cdot q
$$

äºæ˜¯å¯ä»¥é€šè¿‡çˆ†ç ´æ±‚å‡º $p$ å’Œ $q$  æ¥è¿›è¡Œæ±‚è§£ï¼Œä½†æ˜¯é¢˜ç›®æ²¡æœ‰å‘ŠçŸ¥ $e$ ï¼Œå¯ä»¥å…ˆçŒœæµ‹ $e = 65537$ ã€‚æ ¹æ®è¿™ä¸ªæ€è·¯å†™ä¸ªå®Œæ•´è„šæœ¬ï¼š^1^

```python
import libnum, gmpy2, itertools

A =  2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724
n =  117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127
c =  41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128

x , y = 2, 83
A_t = (((y%x)**5)%(x%y))**2019+y**316+(y+1)/x
assert A_t == A

for q in itertools.count(gmpy2.iroot(n//166,2)[0]):
    if n%q == 0:
        break
p = n//q

assert n == p*q
e = 65537
phi = (p-1)*(q-1)
d = gmpy2.invert(e, phi)
m = gmpy2.powmod(c,d,n)
flag = libnum.n2s(m)

print flag
```

è¿è¡Œè„šæœ¬ï¼Œå³å¯å¾—åˆ°flagï¼š

```txt
RoarCTF{wm-l1l1ll1l1l1l111ll}
```

è¿™é“é¢˜ç›®çš„æ±‚è§£æ–¹æ³•æ˜¯ä¼˜é›…ä¸æš´åŠ›ç›¸ç»“åˆçš„ï¼Œèƒ½å±•ç°å‡ºä¸€ç§ç‰¹åˆ«çš„ç¾æ„Ÿï¼Œæ•°å­¦æ¨å¯¼çš„ä¼˜é›…å’Œè›®åŠ›æ”»å‡»çš„æš´åŠ›ã€‚é‡è›®ä¸ä¼˜é›…ï¼Œå±•ç°å‡ºå¯†ç å­¦ç‹¬æœ‰ç¾ï¼Œé¢˜ç›®è¿˜æ˜¯æŒºä¸é”™çš„ã€‚

##  0xE [AFCTF2018]Single

å•ä¸€çš„ï¼Œçœ‹çœ‹é¢˜ç›®ç»™äº†æˆ‘ä»¬ä»€ä¹ˆåŒ…è£¹å§ï¼

ä¸€ä¸ª`Cipher.txt`å¯†æ–‡æ–‡ä»¶å’Œä¸€ä¸ª`Encode.cpp`åŠ å¯†æ–‡ä»¶ã€‚

Encode.cpp

```c++
#include <bits/stdc++.h>
using namespace std;
int main()
{
	freopen("Plain.txt","r",stdin);
	freopen("Cipher.txt","w",stdout);
	map<char, char> f;
	int arr[26];
	for(int i=0;i<26;++i){
		arr[i]=i;
	}
	random_shuffle(arr,arr+26);
	for(int i=0;i<26;++i){
		f['a'+i]='a'+arr[i];
		f['A'+i]='A'+arr[i];
	}
	char ch;
	while((ch=getchar())!=EOF){
		if(f.count(ch)){
			putchar(f[ch]);
		}else{
			putchar(ch);
		}
	}
	return 0;
}
```

Cipher.txt

```txt
Jmqrida rva Lfmz (JRL) eu m uqajemf seny xl enlxdomrexn uajiderc jxoqarerexnu. Rvada mda rvdaa jxooxn rcqau xl JRLu: Paxqmdyc, Mrrmjs-Yalanja mny oekay.

Paxqmdyc-urcfa JRLu vmu m jxiqfa xl giaurexnu (rmusu) en dmnza xl jmrazxdeau. Lxd akmoqfa, Wab, Lxdanuej, Jdcqrx, Benmdc xd uxoarvenz afua. Ramo jmn zmen uxoa qxenru lxd atadc uxftay rmus. Oxda qxenru lxd oxda jxoqfejmray rmusu iuimffc. Rva nakr rmus en jvmen jmn ba xqanay xnfc mlrad uxoa ramo uxfta qdatexiu rmus. Rvan rva zmoa reoa eu xtad uio xl qxenru uvxwu cxi m JRL wenad. Lmoxiu akmoqfa xl uijv JRL eu Yaljxn JRL gimfu.

Waff, mrrmjs-yalanja eu mnxrvad enradaurenz seny xl jxoqarerexnu. Vada atadc ramo vmu xwn narwxds(xd xnfc xna vxur) werv tifnmdmbfa uadtejau. Cxid ramo vmu reoa lxd qmrjvenz cxid uadtejau mny yatafxqenz akqfxeru iuimffc. Ux, rvan xdzmnehadu jxnnajru qmdrejeqmnru xl jxoqarerexn mny rva wmdzmoa urmdru! Cxi uvxify qdxrajr xwn uadtejau lxd yalanja qxenru mny vmjs xqqxnanru lxd mrrmjs qxenru. Veurxdejmffc rveu eu m ledur rcqa xl JRLu, atadcbxyc snxwu mbxir YAL JXN JRL - uxoarvenz fesa m Wxdfy Jiq xl mff xrvad jxoqarerexnu.

Oekay jxoqarerexnu omc tmdc qxuuebfa lxdomru. Er omc ba uxoarvenz fesa wmdzmoa werv uqajemf reoa lxd rmus-bmuay afaoanru (a.z. IJUB eJRL).

JRL zmoau xlran rxijv xn omnc xrvad muqajru xl enlxdomrexn uajiderc: jdcqrxzdmqvc, urazx, benmdc mnmfcueu, datadua anzanaadenz, oxbefa uajiderc mny xrvadu. Zxxy ramou zanadmffc vmta urdxnz useffu mny akqadeanja en mff rvaua euuiau.

Iuimffc, lfmz eu uxoa urdenz xl dmnyxo ymrm xd rakr en uxoa lxdomr. Akmoqfa mljrl{Xv_I_lxiny_er_neja_rDc}
```

çœ‹æ ·å­ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªæ›¿æ¢åŠ å¯†çš„é¢˜ç›®ã€‚å¯ä»¥ç›´æ¥æ‰”è¿›[è¯é¢‘åˆ†æç½‘ç«™](https://quipqiup.com/)è¿›è¡Œè¯é¢‘åˆ†ææ¥æ±‚è§£ï¼Œå¾—åˆ°æ±‚è§£ç»“æœï¼š

```txt
	Capture the Flag (CTF) is a special kind of information security competitions. There are three common types of CTFs: Jeopardy, Attack-Defence and mixed. Jeopardy-style CTFs has a couple of questions (tasks) in range of categories. For example, Web, Forensic, Crypto, Binary or something else. Team can gain some points for every solved task. More points for more complicated tasks usually. The next task in chain can be opened only after some team solve previous task. Then the game time is over sum of points shows you a CTF winer. Famous example of such CTF is Defcon CTF quals. Well, attack-defence is another interesting kind of competitions. Here every team has own network(or only one host) with vulnarable services. Your team has time for patching your services and developing exploits usually. So, then organizers connects participants of competition and the wargame starts! You should protect own services for defence points and hack opponents for attack points. Historically this is a first type of CTFs, everybody knows about DEF CON CTF - something like a World Cup of all other competitions. Mixed competitions may vary possible formats. It may be something like wargame with special time for task-based elements (e.g. UCSB iCTF). CTF games often touch on many other aspects of information security: cryptography, stego, binary analysis, reverse engeneering, mobile security and others. Good teams generally have strong skills and experience in all these issues. Usually, flag is some string of random data or text in some format. Example afctf{Oh_U_found_it_nice_tRy}
```

å¿«ç§ï¼Œflagå°±åœ¨æœ€åä¸€è¡Œï¼è¿™é¢˜å°±è¿™ä¹ˆå®Œäº†ï¼Œæœ‰å·¥å…·çœŸæ˜¯å¥½(\*\^\_\^\*)

##  0xF [WUSTCTF2020]B@se

çœ‹é¢˜ç›®ï¼Œåº”è¯¥æ˜¯ä¸€é“BASEçš„é¢˜ç›®ã€‚çœ‹çœ‹é™„ä»¶ä¼šç»™äº›ä»€ä¹ˆå§ï¼

```txt
å¯†æ–‡ï¼šMyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD==
JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs****kxyz012789+/

oh holy shit, something is missing...
```

è¿™é“é¢˜ç›®çš„åº”è¯¥æ˜¯å˜æ¢äº†ç¼–ç è¡¨çš„base64ï¼Œä¿®æ”¹å¹¶æ›¿æ¢ä¸€ä¸‹ä½¿ç”¨base64è¿›è¡Œè§£å¯†ï¼Œä½†æ˜¯å˜æ¢åçš„ç¼–ç è¡¨ä¸­æœ‰å››ä¸ªå­—æ¯æ˜¯é¡ºåºä½ç½®ï¼Œå› æ­¤å¯èƒ½ä¼šæœ‰24ç§å¯èƒ½çš„æƒ…å†µã€‚éœ€è¦è¿›è¡Œçˆ†ç ´ï¼Œé¦–å…ˆè¦çŸ¥é“æ˜¯é‚£äº›å­—ç¬¦ç¼ºå¤±äº†ï¼Œç„¶åå¯¹ç¼ºå¤±å­—ç¬¦çš„æ•°ç»„è¿›è¡Œçˆ†ç ´ï¼Œç„¶ååœ¨ä½¿ç”¨base64æ›¿æ¢æ¥è¿›è¡Œbase64çš„æ±‚è§£ã€‚æ ¹æ®è¿™ä¸ªæ€è·¯æ¥å†™ä¸ªè„šæœ¬ï¼š

```python
import base64
import string
import itertools

base64_stand = string.uppercase+string.lowercase+string.digits+"+/"
new_base64 = "JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs****kxyz012789+/"
lose_letters =""
c = "MyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD=="
flags = []

def base64_change(c,s,n):
    result = ""
    for i in c:
        if n.find(i) != -1:
            result += s[n.find(i)]
        else:
            result += i
    result = base64.b64decode(result)
    if len(result)+2 == len(repr(result)):
        return result
    else:
        return

for i in base64_stand:
    test = new_base64.find(i)
    if test == -1:
        lose_letters += i

for i in list(itertools.permutations(lose_letters,4)):
    m = "".join(i)
    base64_new = new_base64.replace("****", m)
    flag = base64_change(c, base64_stand, base64_new)
    if flag and "2020" in flag:
        flags.append(flag)

for flag in set(flags):
    print flag
```

è¿è¡Œè„šæœ¬ï¼Œå¾—åˆ°å¯èƒ½çš„flagï¼š

```txt
wctf2020{base64_1s_v3ry_e@sy_and_fuN}
wctf2020{bare64_!r_v2ry_e@ry_and_fuN}
```

ç»è¿‡æµ‹è¯•ï¼Œflagåº”è¯¥æ˜¯ï¼š

```txt
wctf2220{base64_1s_v3ry_e@sy_and_fuN}
```

æœ¬é¢˜åˆ°æ­¤ç»“æŸï¼

## å‚è€ƒ

1. [CTF RSAé¢˜è§£é›† (ruanx.net)](https://www.ruanx.net/rsa-solutions/)
